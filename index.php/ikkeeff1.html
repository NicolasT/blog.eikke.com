<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">


<!-- Mirrored from blog.eikke.com/index.php/ikke?blog=5&cat=19&page=1&paged=4 by HTTrack Website Copier/3.x [XR&CO'2010], Tue, 11 Dec 2012 19:40:37 GMT -->
<head>
                <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <title>Ikke's Blog - Category: Desktop</title>
        <base  />        <meta name="description" content="Just my weBlog" />
        <meta name="keywords" content="nicolas trangez ikke eikke blog code linux desktop gnome dbus hal freedesktop ivman css xhtml code dump gallery c programming computing" />
        <meta name="generator" content="b2evolution 1.8.6" /> <!-- Please leave this for stats -->
        <link rel="alternate" type="text/xml" title="RDF" href="http://eikke.com/feed/" />
        <link rel="alternate" type="text/xml" title="RSS .92" href="http://eikke.com/feed/" />
        <link rel="alternate" type="text/xml" title="RSS 2.0" href="http://eikke.com/feed/" />
        <link rel="alternate" type="application/atom+xml" title="Atom" href="http://eikke.com/feed/" />
        <link rel="pingback" href="../xmlsrv/xmlrpc.php" />
  <link rel="stylesheet" type="text/css" href="../skins/nautica05-2col/css/layout.css" media="screen, projection, tv " />
  <link rel="stylesheet" type="text/css" href="../skins/nautica05-2col/css/html.css" media="screen, projection, tv " />

  <!-- CSS specific to current theme -->
  <link rel="stylesheet"           type="text/css" href="../skins/nautica05-2col/css/light.html" title="light" media="screen, projection, tv " />
  <link rel="alternate stylesheet" type="text/css" href="../skins/nautica05-2col/css/dark.html"  title="dark"  media="screen, projection, tv " />
        </head>

<body>

<!-- #content: holds all except site footer - causes footer to stick to bottom -->
<div id="content">

  <!-- #header: holds the logo and top links -->
  <div id="header" class="width">

    <img src="../skins/nautica05-2col/images/logo.gif" alt="Your logo goes here"/>
<ul id="bloglist"><li><a href="all.html" class="BlogButton" title="All Blogs">Blog All</a></li>
<li><a href="ikke.html" class="BlogButtonCurr" title="Ikke&#039;s Blog">Ikke</a></li>
<li><a href="fedorastateless.html" class="BlogButton" title="Fedora Stateless @ UGent">FSU</a></li>
<li><a href="realnitro.html" class="BlogButton" title="RealNitro&#039;s Blog">RealNitro</a></li>
<li><a href="http://peterdedecker.net/blog/index.php" class="BlogButton" title="Peter&#039;s Blog">Peter</a></li>
</ul>
    <!-- Or, comment out the bloglist and add your own links up here
    <ul>
      <li><a href="index.html">Back to Main page</a></li>
      <li><a href="">About us</a></li>
      <li><a href="">Streaming Video</a></li>
      <li><a href="" class="last">RSS Feeds</a></li>
    </ul>-->

  </div>
  <!-- #header end -->


  <!-- #headerImg: holds the main header image or flash -->
  <div id="headerImg" class="width"></div>



  <!-- #menu: the main large box site menu -->
  <div id="menu" class="width">
<!-- More links you could use if you want
    <ul>
      <li>
        <a href="onecol.html" onfocus="blur()">
          <span class="title ">One Column Layout</span>
          <span class="desc">View the included layout</span>        </a>      </li>
      <li>
        <a href="twocol_a.html" class="forum" onfocus="blur()">
          <span class="title ">Two Column Layout A</span>
          <span class="desc style3">View the included layout</span>        </a>      </li>
      <li>
        <a href="twocol_b.html" onfocus="blur()">
          <span class="title ">Two Column Layout B</span>
          <span class="desc">View the included layout</span>
        </a>
      </li>
      <li>
        <a href="contact.html" onfocus="blur()">
          <span class="title ">Contact Us Layout</span>
          <span class="desc">View the included layout</span>
        </a>
      </li>
    </ul>
    -->
  </div>
  <!-- #menu end -->



  <!-- #page: holds the page content -->
  <div id="page">


    <!-- #columns: holds the columns of the page -->
    <div id="columns" class="widthPad">


    <!-- Left column -->
    <div class="floatLeft width73">

<h1 style="margin-top:5px"><span class="dark"><a href="ikke.html">Ikke's Blog</a></span></h1>



<!-- =================================== START OF MAIN AREA =================================== -->

<div class="action_messages"></div>
<h2>Category: Desktop</h2>
        <div class="bPost bPostpublished" lang="en-US">
                      <!-- Start Post -->
      <div class="post">

        <div class="date">
          <span class="month">Apr</span>
          <span class="day">19</span>
        </div>
<div class="bPost">
          <span class="title">New prototype</span>

                        <p>Lots of traffic on GIMPNet today, many different and interesting things were discussed between some GNOME hackers. But I guess others will write about those things (Philip? Jeff?).<br />
Anyway, more related to myself and my own project (yeah, CDIS, you know): I had a great talk with Robert "Robot101" McQueen, who gave some very sensible insights in the D-BUS system, and how I could (ab)use it.<br />
First of all, last night I was thinking about the D-BUS glossary a little, and came to the conclusion that "interfaces" might at a certain level be compared to "namespaces" instead of "interfaces", at least in some point of views. Might be interesting if you try to "get" D-BUS. Questions? Leave a comment ;-)</p>

<p>After this talk and some help from J5, #1 python-dbus guru, I managed to get a new sample setup working. In this new design, there is no central daemon at all any longer, which is great, obviously. Some changes/enhancements to the D-BUS bindings might be necessary though (I hate the fact you can't get the sender service/object path in a signal handler!).</p>

<p>As a picture says more than a thousand words, first open up this <a href="http://www.eikke.com/files/cdis-signal-setup.png" title="screenshot">screenshot</a>. Code's <a href="http://code.eikke.com/index.php?dir=CDIS/newstyle/" title="here">here</a>.<br />
As you can see, first the user starts his favorite media player, RhythmBox, and spins his favorite song (1). In the background, a screensaver application is running (in the sample I started it after RB, but hey, its a sample) (2). After a while (3 seconds ;-)), the user starts his VoIP softphone, Ekiga (3). As the user is very popular, he almost immediately receives a call, and accepts it (4).<br />
As you can see, Ekiga knows about music players, and asks them to pause playback. RB is CDIS-aware, and stops playing (5). Obviously, the music player should do a generic "Paused" signal here (see later). Next, Ekiga sends out a signal on the org.freedesktop.CDIS.SoftPhone interface, "IncomingCall". This signal can be used by any application listening for it. It is not related to pausing music players: in (4-5), Ekiga tells all music players to pause. It knows about this kind of applications, and knows how to handle them. In (6) Ekiga provides application types it doesn't know about (or, maybe more likely, doesn't want to know about, doesn't care about) to do some action based on the fact there's an incoming call.<br />
As this is a video conference, the screensaver traps that signal, and stops his internal timer (7).<br />
After a while, the call is over, the user disconnects (8). Ekiga sends now tells all music players they can resume playback if they were playing before (9). It also sends out a "CallTerminated" signal on the SoftPhone interface, which is again seen by the screensaver, who restarts his timer.<br />
Then, something happens that will/should not be supported, but I just implemented it as a sample. When the screensaver decides it's time to blank the screen (11), it tells all SoftPhones to go "Idle" (12). This is not the way we should handle this in "real" applications, as a screensaver should not put SoftPhones in idle state, it should send out a signal "ScreenSaverStarted", the softphone should watch for that one, and go idle when the screen blanks. Anyway, I just wanted to give one more example of the "action" paradigm, just like "Pause" and "Resume" on the MediaPlayer interface.</p>

<p>As usual, the prototype code is extremely ugly, but it does show what I got in mind regarding code generation. There should be 3 "objects":</p>
<ul><li>CdisMusicPlayer: inherited by a "real" music player, or by some internal CdisHandler object. Needs function pointers to all supported CDIS function calls. In the sample, used by RhythBox.</li>
<li>CdisMusicPlayerController: Used by code that wants to control a class of applications. Used by Ekiga to pause all music players. Only provides "active" functions that, when called, result in a change on remote objects.</li>
<li>CdisSoftPhoneClient: helper class for "generic" applications that want to be notified about things by a SoftPhone application. Used by ScreenSaver to be able to work with SoftPhone applications on the system, as the SoftPhone doesnt know about screensavers</li></ul>
<p>For all of these objects, I'm sure there's some pattern for them. Philip, help! :-)</p>

<p>This should be fairly clear I guess... If not, ask. Lots of things can/will/should change, eg authorisation, and issue raised by sri yesterday. Don't know yet how this should be tackled thogh.<br />
Duplicate events should be prohibited too (although this can for a big part be done by having well designed interfaces): when app A asks MusicPlayers to pause, then B does the same, and A sends a "Resume" signal, the player(s) should not resume unless B also sends the "Resume" command. This and other issues will need to be fixed!</p>

<p>After all a pretty fun day :-) Although you can't imagine how much I hate Blast by now :> Big thanks to all help on IRC, I should get all of you a beer at GUADEC. Sadly enough due to exams I can't be there though ;-)</p>                              <!-- End Post -->
                  <div><script type="text/javascript"><!--
      google_ad_client = "pub-7170970013053423";
      //blog.eikke.com links
      google_ad_slot = "9622796794";
      google_ad_width = 468;
      google_ad_height = 15;
      //--></script>
      <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script></div>
                      <div class="bSmallPrint">
                        Ikke &bull; <strong><a href="ikke3f99.html?cat=16" title="Browse category">Technology</a></strong>, <a href="ikkec055.html?cat=17" title="Browse category">Linux</a>, <a href="ikke8e7f.html?cat=19" title="Browse category">Desktop</a>, <a href="ikke3cd0.html?cat=49" title="Browse category">Coding Corner</a><a href="ikke/2006/04/19/new_prototype.html" title="Permanent link to full entry" class="permalink_right"><img src="../rsc/icons/minipost.gif" border="0" align="top" width="12" height="9"  class="middle" alt="Permalink"/></a>
                        <a href="ikke/2006/04/19/new_prototype.html#comments" title="Display comments / Leave a comment">9 comments</a>                                                                        
                        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
  rdf:about="http://blog.eikke.com/index.php/ikke/2006/04/19/new_prototype"
  dc:identifier="http://blog.eikke.com/index.php/ikke/2006/04/19/new_prototype"
  dc:title="New prototype"
  trackback:ping="http://blog.eikke.com/htsrv/trackback.php/465" />
</rdf:RDF>-->
                </div>
</div>
                        </div>
      </div>
                <div class="bPost bPostpublished" lang="en-US">
                      <!-- Start Post -->
      <div class="post">

        <div class="date">
          <span class="month">Apr</span>
          <span class="day">18</span>
        </div>
<div class="bPost">
          <span class="title">More CDIS spam</span>

                        <p>First of all: Evolution is sooooo "1337":<br />
<center><img src="http://www.eikke.com/files/evo-hex2.png" title="EvoHex" /></center></p>

<p>Guess what: I've been thinking some more about CDIS. Yesterday I had a little discussion about it on #gnome-hackers with Robot101, who seems to have some good knowledge of D-BUS. Obviously, he rejected the idea of adding one more daemon. Indeed, it shouldn't be there, I hate it myself too, but currently it's the only solution to get things working.<br />
He suggested to specify some well-known service and object names, and call methods on the desired services that way. This is not a possible solution though: think of someone running 2 VoIP softphones (eg Ekiga and Skype), 2 IM clients (Gossip for Jabber, aMSN for MSNP),... A service is unique for one application.</p>

<p>So some other solution should be found.<br />
The best one, IMHO, is to add a method to the org.freedesktop.DBus service/object, something like "GetObjectsByInterface", which accepts a string, and returns an array of (servicename, objectpath) tupples, both strings. Using that one can do a specific call on all objects that need to be called.</p>

<p>Next to that, there's the versioning issue. If I remember correctly, a long long time ago this has been discussed on the D-BUS mailing list, and people decided interface versioning support wouldn't be added to D-BUS. As the CDIS interface specifications won't ever be "final", it should be possible to get around this.<br />
It's not that hard though. We can use the standard x.y versioning system, x.y is backwards compatible with x.(y-1), so in a version bump from x.y to x.(y+1) only methods or signals can be added. Bumping x allows a complete API break.<br />
Like this, if we release version 1.2 of the org.freedesktop.CDIS.FooInterface interface, and application FooApp got an object implementing this interface version, it should register itself to the D-BUS sessionbus, and tell it it implements org.freedesktop.CDIS.FooInterface.1.0, org.freedesktop.CDIS.FooInterface.1.1 and org.freedesktop.CDIS.FooInterface.1.2. Now if some other application wants to call a function added in version 1.1 of our spec, it just checks what service/objectpath pairs implement org.freedesktop.CDIS.1.1, and calls the method(s).<br />
All this can be done behind the scenes by some helper library that makes it easier to make applications CDIS-aware.</p>

<p>As now is the time to come up with some project for Google's Summer of Code, I think it'd be great to work on this (now don't steal the idea). The only issue is: <b>would someone be willing to mentor this</b>?<br />
I'd like to do the initial work somewhere under the hood of the GNOME project, if that'd be possible/allowed/accepted.</p>

<p>Here's a TODO:</p>
<ul><li>Add the previously described method to the D-BUS service</li>
<li>Come up with some XML format to define CDIS interfaces, including interface version support</li>
<li><p>Write code generators that generate helper libraries based on these XML descriptions. Some ideas:</p>
<ul><li>Plain C: using vtables with function pointers</li>
<li>GObject: standard GObject things like signals and GObject interfaces</li>
<li>Python: decorators</li>
<li>CLI/C#: decorators too</li></ul>
<p>The helpers should use the language-native D-BUS bindings, which makes things easier to debug (IMHO)</p></li>
<li>Write up an initial interface for some specific service type, and make some projects ("servers") aware of it</li>
<li>Change some other applications ("clienst") so they can make use of the servers</li></ul>

<p>Regarding the helper libs: these should abstract the complete D-BUS backend and versioning issues from the actual application. An application should just initialize it, say "Hey, I'm a MusicPlayer, I want to support version x.y of the org.freedesktop.CDIS.MusicPlayer interface, here are my callbacks".<br />
In pseudocode:</p><pre><code>/* Hello world, I want to implement a CDIS interface */
CdisMusicPlayer *cdis_self = cdis_musicplayer_new("1.2", "com.eikke.CoolPlayer", "/com/eikke/CoolPlayer/CDISController");
/* When a client makes a "pause" call to apps implementing org.freedesktop.CDIS.MusicPlayer, please jump to myapp_playback_pause
 * This uses D-BUS methods
 */
cdis_musicplayer_set_playback_pause_cb(cdis_self, myapp_playback_pause);
/* Hey listeners out there, I started playback
 * This sends out a D-BUS signal
 */
cdis_musicplayer_playback_started(cdis_self);</code></pre>

<p>Next to the server object, there are clients:</p><pre><code>/* Hey, I'd like to control music players. I support version 1.5 of the org.freedesktop.CDIS.MusicPlayer interface */
CdisMusicPlayerClient *c = cdis_musicplayer_client_new_with_bus("1.5", my_dbus_connection);
/* If a player starts, please run this callback */
cdis_mediaplayer_client_set_playback_started_cb(c, playback_started);
/* Tell all MusicPlayers to pause */
cdis_mediaplayer_client_pause(c);</code></pre><p>Maybe the "object" instance isn't even necessary!</p>

<p>Behind the scenes, when the client calls cdis_musicplayer_client_pause(), the helper will know this method was added in version 1.1 of the specification. It will request a list of all service/object-pairs that implement the org.freedesktop.CDIS.MusicPlayer.1.1 interface from the D-BUS service, and do the Pause() call on all returned objects.<br />
When the server "connects" to the system, telling it implements version 1.2 of the spec, the helper will connect to the session bus and will tell the D-BUS system the object implements org.freedesktop.CDIS.MusicPlayer.1.0, org.freedesktop.CDIS.MusicPlayer.1.1 and org.freedesktop.CDIS.MusicPlayer.1.2.</p>

<p>Like this it should be fairly trivial to make existing and new applications CDIS aware. And that's the way it should be ;-)</p>

<p>Obviously, an application could use "pure" D-BUS calls to handle all this itself too. But why make things so complicated?</p>

<p>Next to that, it should be possible to write "testkits" too, based on the XML specs. Python might be very usefull here. One test then looks up the highest version of the spec, and executes all methods new in this version on all objects claiming to implement the interface. Then it takes the last-but-one version, and does the same thing, all the way down to x.0. This way an application developer can easily check whether his application is CDIS compliant. This needs some more thinking though ;-)</p>

<p>Anyway, lots of things to be done, and obviously, not all of this can be done in only 2 or 3 months. Still, some results/progress can be made, and I'm 99% certain incorporating this in the desktop would be a great thing.<br />
I know one should just apply for SoC without thinking about a mentor. I would like to know someone'd want to be mine though before applying (just to be on the safe side), so if these things interest you and you want to get some experience on the mentor side of things, please let me know!</p>                              <!-- End Post -->
                            <div class="bSmallPrint">
                        Ikke &bull; <a href="ikke3f99.html?cat=16" title="Browse category">Technology</a>, <a href="ikkec055.html?cat=17" title="Browse category">Linux</a>, <strong><a href="ikke8e7f.html?cat=19" title="Browse category">Desktop</a></strong>, <a href="ikke3cd0.html?cat=49" title="Browse category">Coding Corner</a><a href="ikke/2006/04/18/more_cdis_spam.html" title="Permanent link to full entry" class="permalink_right"><img src="../rsc/icons/minipost.gif" border="0" align="top" width="12" height="9"  class="middle" alt="Permalink"/></a>
                        <a href="ikke/2006/04/18/more_cdis_spam.html#comments" title="Display comments / Leave a comment">7 comments</a>                                                                        
                        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
  rdf:about="http://blog.eikke.com/index.php/ikke/2006/04/18/more_cdis_spam"
  dc:identifier="http://blog.eikke.com/index.php/ikke/2006/04/18/more_cdis_spam"
  dc:title="More CDIS spam"
  trackback:ping="http://blog.eikke.com/htsrv/trackback.php/464" />
</rdf:RDF>-->
                </div>
</div>
                        </div>
      </div>
                <div class="bPost bPostpublished" lang="en-US">
                      <!-- Start Post -->
      <div class="post">

        <div class="date">
          <span class="month">Apr</span>
          <span class="day">17</span>
        </div>
<div class="bPost">
          <span class="title">Easter hacking</span>

                        <p>Writing code on easter day, after spending a day with your family (including the obligatory champagn/wine/beers) isn't such a good idea (#gnome-nl):</p>
<pre>23:43 &lt;@ikke&gt; damn, help!
23:43 &lt;@ikke&gt; g_return_if_fail(foo() != TRUE)
23:43 &lt;@ikke&gt; returnt dat nu al foo() TRUE is, of FALSE?
23:43 &lt;@ikke&gt; ik ben helemaal aant flippen :s
23:43 &lt;@kris&gt; het failt als foo() != TRUE niet true is
23:43 &lt;@kris&gt; dus als foo() true returned
23:43 &lt;@ikke&gt; dus returnt als foo true is
23:43 &lt;@kris&gt; oh nee
23:43 &lt;@kris&gt; wacht ff
23:43 &lt;@ikke&gt; kijk, jij ook al :p
23:44 &lt;@kris&gt; all foo() false returnt, is foo() != TRUE true
23:44 &lt;@kris&gt; ja
23:44 &lt;@kris&gt; dus het failt als foo() true returnt
23:44 &lt;@ikke&gt; dus ie returnt als foo true is
23:44 &lt;@kris&gt; want dan is foo() != TRUE false
23:44 &lt;+qball&gt; leuk he :D</pre>
<p>For the people who dont know dutch out there:</p>
<pre>23:43 &lt;@ikke&gt; damn, help!
23:43 &lt;@ikke&gt; g_return_if_fail(foo() != TRUE)
23:43 &lt;@ikke&gt; does it return if foo() is TRUE, or FALSE?
23:43 &lt;@ikke&gt; I'm going nuts :s
23:43 &lt;@kris&gt; hit fails when foo() != TRUE isn't true
23:43 &lt;@kris&gt; so, when foo() returns true
23:43 &lt;@ikke&gt; so it returns when foo is true
23:43 &lt;@kris&gt; oh no
23:43 &lt;@kris&gt; wait a moment
23:43 &lt;@ikke&gt; look, you got the same issue :P
23:44 &lt;@kris&gt; when foo() returns false, foo() != TRUE is true
23:44 &lt;@kris&gt; yes
23:44 &lt;@kris&gt; so it fails when foo() returns true
23:44 &lt;@ikke&gt; it returns when foo is true
23:44 &lt;@kris&gt; caus then foo() != TRUE is false
23:44 &lt;+qball&gt; fun heh :D</pre>
<p>Oh well, it's fixed :-)</p>

<p>I got <a href="http://gentopia.gentooexperimental.org/" title="Gentopia">Gentopia</a> SVN commit access now. Gentopia is a project set up by some <a href="http://www.gentoo.org/" title="Gentoo">Gentoo</a> devs aiming to get the Project Utopia stack properly integrated in the distribution. I committed an <a href="http://gentopia.gentooexperimental.org/browser/overlay/net-misc/networkmanager-vpnc/networkmanager-vpnc-0.6.0.ebuild" title="updated networkmanager-vpnc">updated networkmanager-vpnc</a> version, enjoy ;-)<br />
<a href="http://bugzilla.gnome.org/show_bug.cgi?id=338741" title="Cleaned up">Cleaned up</a> the <a href="http://www.gnome.org/projects/NetworkManager/" title="NetworkManager">NetworkManager</a> Gentoo backend a little too.</p>

<p>Could someone tell me how to mark a bug as a dupe in Bugzilla?</p>

<p>No CDIS mails yet, busy for some uni project (<a href="http://twizz.ugent.be/student/prog2/blast/" title="link">link</a>) taking too much of my time, which I don't like actually ;-) Looks like some people <a href="http://www.linux-wizard.net/index.php?id_blog=68" title="picked">picked</a> <a href="http://live.gnome.org/SummerOfCode2006/Ideas" title="up">up</a> <a href="http://bugzilla.gnome.org/show_bug.cgi?id=338131" title="the">the</a> idea though, great!</p>

<p>Next to that: jay for new fglrx drivers! Now I *will* be able to run Linux on my laptop when I get it (will not be within next 2 months though I'm afraid :-(), which is some *great* news.</p>                              <!-- End Post -->
                            <div class="bSmallPrint">
                        Ikke &bull; <strong><a href="ikke3f99.html?cat=16" title="Browse category">Technology</a></strong>, <a href="ikkec055.html?cat=17" title="Browse category">Linux</a>, <a href="ikke8e7f.html?cat=19" title="Browse category">Desktop</a>, <a href="ikke3cd0.html?cat=49" title="Browse category">Coding Corner</a><a href="ikke/2006/04/17/easter_hacking.html" title="Permanent link to full entry" class="permalink_right"><img src="../rsc/icons/minipost.gif" border="0" align="top" width="12" height="9"  class="middle" alt="Permalink"/></a>
                        <a href="ikke/2006/04/17/easter_hacking.html#comments" title="Display comments / Leave a comment">2 comments</a>                                                                        
                        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
  rdf:about="http://blog.eikke.com/index.php/ikke/2006/04/17/easter_hacking"
  dc:identifier="http://blog.eikke.com/index.php/ikke/2006/04/17/easter_hacking"
  dc:title="Easter hacking"
  trackback:ping="http://blog.eikke.com/htsrv/trackback.php/463" />
</rdf:RDF>-->
                </div>
</div>
                        </div>
      </div>
                <div class="bPost bPostpublished" lang="en-US">
                      <!-- Start Post -->
      <div class="post">

        <div class="date">
          <span class="month">Apr</span>
          <span class="day">12</span>
        </div>
<div class="bPost">
          <span class="title">First CDIS "proof of concept"</span>

                        <p>Well, proof of concept, it's not that much actually :-)<br />
Been fighting with DBus today to get something as I described yesterday working. Thanks to the people on the mailing list and IRC (#dbus@freenode) for all help, hints and pointers!</p>

<p>I hacked together a very small sample in Python (yes, I hardly know Python, so the code might be very very bad, I just wanted to test whether what I want to do is possible using DBus).</p>

<p>The setup uses a central daemon (don't shoot! It looks like it's the only usable way to cut the job) which keeps track of all objects that want to implement some CDIS interface. Objects subscribe to the concentrator (thats how I called it anyway), and clients talk to it too.<br />
See <a href="http://www.eikke.com/files/cdis-first-poc.png" title="this screenshot">this screenshot</a> to get an overview how it works. First the concentrator is started. Then the user starts Gaim and Kopete (this is just a sample, obviously). They both register to the concentrator, which keeps track of them. Now some user app (think "a screensaver") connects to the concentrator, and asks it to set the status of all IM clients to "idle".<br />
The concentrator receives this request, checks his list of connected objects, and runs the "SetState(s)" method on all objects implementing org.freedesktop.CDIS.InstantMessenger.</p>

<p>All of this is completely transparant to the actual application: it doesn't know about DBus, it shouldn't care about subscribing to the concentrator (unsubscribing can be done using NameOwnerChanged etc, not implemented yet) etc. Just provide all functions to implement the inteface.</p>

<p>The best way to tackle this, I think, is to write the specs using some XML format (we might want to look at the dbus-glib-bindings format), then generating code using that (plain C using function pointers, GObjects and their signals, QObjects and their in-process signal mechanism, dunno about the best way to do this in Python and others). It should be fairly painless to get this working.</p>

<p>Other TODO's:</p>
<ul><li>Write a *decent* concentrator (this one can be started using DBus activation on the first subscription call, jay!) that's error-savvy, handles killed applications, can scan the bus on startup for existing objects it should handle,...</li>
<li>Write a spec XML format</li>
<li>Write specs (this one will be the hardest part I guess)</li>
<li>Get desktop apps to use this beast!</li>
<li>Tons of other things</li></ul>

<p>[edit] Per RealNitro's request, code is <a href="http://code.eikke.com/index.php?dir=CDIS/test/" title="online">online</a>. Beware, it's ugly.<br />
I've been thinking: for the Python "bindings", function decorators could be very well suited...<br />
Tomorrow I'll send something about this to XDG, I hope something useful can come out of this.</p>                              <!-- End Post -->
                            <div class="bSmallPrint">
                        Ikke &bull; <a href="ikke3f99.html?cat=16" title="Browse category">Technology</a>, <a href="ikkec055.html?cat=17" title="Browse category">Linux</a>, <a href="ikke8e7f.html?cat=19" title="Browse category">Desktop</a>, <strong><a href="ikke3cd0.html?cat=49" title="Browse category">Coding Corner</a></strong><a href="ikke/2006/04/12/first_cdis_proof_of_concept.html" title="Permanent link to full entry" class="permalink_right"><img src="../rsc/icons/minipost.gif" border="0" align="top" width="12" height="9"  class="middle" alt="Permalink"/></a>
                        <a href="ikke/2006/04/12/first_cdis_proof_of_concept.html#comments" title="Display comments / Leave a comment">3 comments</a>                                                                        
                        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
  rdf:about="http://blog.eikke.com/index.php/ikke/2006/04/12/first_cdis_proof_of_concept"
  dc:identifier="http://blog.eikke.com/index.php/ikke/2006/04/12/first_cdis_proof_of_concept"
  dc:title="First CDIS &quot;proof of concept&quot;"
  trackback:ping="http://blog.eikke.com/htsrv/trackback.php/462" />
</rdf:RDF>-->
                </div>
</div>
                        </div>
      </div>
                <div class="bPost bPostpublished" lang="en-US">
                      <!-- Start Post -->
      <div class="post">

        <div class="date">
          <span class="month">Apr</span>
          <span class="day">11</span>
        </div>
<div class="bPost">
          <span class="title">Common interfaces</span>

                        <p>The recent discussion on <a href="http://mail.gnome.org/mailman/listinfo/desktop-devel-list" title="desktop-devel">desktop-devel</a> on the inclusion of <a href="http://www.gnome.org/projects/gnome-power-manager/" title="GNOME Power Manager">GNOME Power Manager</a> into the 2.16 desktop release (big thanks to the developers for this software, it took a while to get suspension working on my desktop but now it does, I really like GPM even if it's no laptop) ended up in two completely different discussions: the usage of notifications (libnotify) and the notification area versus normal applets, and sharing a base daemon with eg the KDE power manager (somewhat related to what <a href="http://www.gnome.org/projects/NetworkManager/" title="NetworkManager">NetworkManager</a> does: a central daemon running as root, and a client applet on top of that, using DBus for IPC, although the power management daemon should not run as root, as all privileged tasks are handled by hald, which runs as root).</p>

<p>The second issue is one which interests me a lot, as more than a year ago (IIRC I was still using Windows as main desktop at that time :oops: as my Linux machine was too slow to run any desktop app) I sent an email to the <a href="http://lists.freedesktop.org/archives/xdg" title="XDG">XDG</a> list about what was to become <a href="http://lists.freedesktop.org/archives/xdg/2005-January/005687.html" title="CDIS">CDIS</a>, the Common Desktop Interface Specification (the email I link to is just the first of bunch of long threads, from the initial idea almost nothing was kept). Lots of email on the list later, no actual result came out of it (which is mainly due to me).</p>

<p>Shared interfaces are, just like open file formats etc, very important. We got some great desktop specifications that ensure a developer his/her code and application will work on all platforms supporting the specification. Think of the notification area spec, autostart spec, .desktop files,...<br />
Shared IPC interfaces (think DBus) are very important too. In the case of a power management app like GPM or it's K* equivalent, they should both use the same interface for several functions, eg "DontHibernateNext5Minutes" (dumb and useless example, but hey). If I write an application that doesn't need user input, but does a lot of work (think of a CD burning app), I don't want the machine my software runs on hibernates during the burning process, whilst it's perfectly possible the user leaves the machine and his sessions idles out. But I don't want some construct like</p>
<pre>if(user_runs_gnome)
    do_gpm_dont_suspend_call();
if(user_runs_kde)
    do_kde_power_manager_dont_suspend_call();</pre>
<p>or something alike. Maybe this isn't a big issue for some simple program, but think of a large app that should be cross-desktop made by some ISV...<br />
Same thing for a DVD player: I don't want to notify both gnome-screensaver, kde-screensaver and whatever they shouldn't pop up next minute, I just want to notify the org.freedesktop.ScreenSaver service it shouldn't take control of the desktop.</p>

<p>Another sample: I'm a VoIP softphone (think <a href="http://www.ekiga.net/" title="Ekiga">Ekiga</a>), and I get an incoming call. Obviously, I'd like all media players that might run on the current console/desktop to pause. I don't want to send one signal to PlayerA using some custom socket, one to PlayerB using his own DBus interface! I just want to notify all media players they should pause, and send a "Pause" signal to (eg) org.freedesktop.CDIS.MediaPlayer. When the call is ended, I could send a "Resume" signal to the same object path.</p>

<p>I don't know whether all this is possible using DBus, still need to read the docs once again (there's some black magic in there, really!), but I guess you get the idea.<br />
Obviously, an application implementing a CDIS interface can also implement extra functionality, and if multiple applications start implementing the same extra functions, this functionality might be added to the a new version of that interface spec. Like this, we never limit the service developers. There can even be "NotImplemented" errors etc.</p>

<p>The only thing we need is getting some developers together in all fields to write down such a spec in some standard format. Not too many people though, so there's less chance of huge flamewars and more results.</p>

<p>Some application types I think of now that can use a shared interface:</p>
<ul><li>Screensavers</li>
<li>Power management</li>
<li>Media players</li>
<li>Instant Messaging apps ("SetStatus(STATUS_AWAY)",...)</li>
<li>Email clients ("NewMailArrived")</li>
<li>...</li></ul>

<p>Maybe it's time to get this on XDG again...</p>

<hr />
<p>Completely unrelated: dear lazyweb, within a month or so (at least, I hope) I should get a laptop computer (<a href="http://www.asus.com/products4.aspx?modelmenu=2&amp;model=1072&amp;l1=5&amp;l2=26&amp;l3=0" title="Asus W3J">Asus W3J</a>, dualcore 2*1.83Ghz, 1GB, 80GB, pretty cool stuff). Obviously I'd like to run Linux on the machine (oops, GNU/Linux, sorry!) once I can, as it got an ATI X1600 GPU which is completely unsupported today.<br />
I was thinking to run both <a href="http://www.gentoo.org/" title="Gentoo Linux">Gentoo Linux</a> (like I do now on my dekstop) and <a href="http://www.ubuntu.com/" title="Ubuntu">Ubuntu</a> on it: Gentoo for development things and just playing around, Ubuntu as "serious" desktop and university stuff. Next to that I also need Windows on it (some university soft is Windows-only).<br />
I wrote down <a href="http://www.eikke.com/files/laptopparts.txt" title="a possible partition layout">a possible partition layout</a> for this setup today, and got some questions about it:</p>
<ul><li>Will this work? The Gentoo part will, as that's +- what I run now, but will Ubuntu be able to handle a foreign bootloader, and the LVM stuff?</li>
<li>Won't I get in trouble by sharing my homedir between both distributions? I shouldn't, but there are no more certainties in life these days</li></ul>
<p>Thanks!</p>                              <!-- End Post -->
                            <div class="bSmallPrint">
                        Ikke &bull; <a href="ikke3f99.html?cat=16" title="Browse category">Technology</a>, <a href="ikkec055.html?cat=17" title="Browse category">Linux</a>, <strong><a href="ikke8e7f.html?cat=19" title="Browse category">Desktop</a></strong><a href="ikke/2006/04/11/common_interfaces.html" title="Permanent link to full entry" class="permalink_right"><img src="../rsc/icons/minipost.gif" border="0" align="top" width="12" height="9"  class="middle" alt="Permalink"/></a>
                        <a href="ikke/2006/04/11/common_interfaces.html#comments" title="Display comments / Leave a comment">6 comments</a>                                                                        
                        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
  rdf:about="http://blog.eikke.com/index.php/ikke/2006/04/11/common_interfaces"
  dc:identifier="http://blog.eikke.com/index.php/ikke/2006/04/11/common_interfaces"
  dc:title="Common interfaces"
  trackback:ping="http://blog.eikke.com/htsrv/trackback.php/461" />
</rdf:RDF>-->
                </div>
</div>
                        </div>
      </div>
        
        <p class="center"><strong>
                <a href="ikke352e.html?blog=5&amp;cat=19&amp;page=1&amp;paged=3">&lt;&lt; Previous Page</a> :: <a href="ikke9abf.html?blog=5&amp;cat=19&amp;page=1&amp;paged=5">Next Page &gt;&gt;</a>                 </strong></p>

    </div>
    <!-- Left column end -->


    <!-- Right link column -->
    <div class="floatRight width25 lightBlueBg horzPad">
               <div class="bSideItem">
                <form action="http://blog.eikke.com/index.php/ikke" method="get" name="SearchForm" class="search">                        <p><input type="text" name="s" size="23" value="" class="SearchField" /><br />
                        <input type="submit" name="submit" class="submit" value="Search" style="margin-top:3px" /></p>
                </form>
        </div>
		<div class="bSideItem">
	<div style='position: relative; left: 25px;'>
	<script type="text/javascript"><!--
	google_ad_client = "pub-7170970013053423";
	//Ikke&#39;s blog
	google_ad_slot = "5340725895";
	google_ad_width = 120;
	google_ad_height = 240;
	//--></script>
	<script type="text/javascript"
	src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
	</script></div>
		</div>
              <div class="catarc"><h3>Categories</h3><ul><li><a href="ikke.html">All</a></li>
<li><a href="ikkeb5e7.html?cat=15">Life</a> <span class="notes">(56)</span></li>
<li><a href="ikke3f99.html?cat=16">Technology</a> <span class="notes">(131)</span><ul><li><a href="ikke3cd0.html?cat=49">Coding Corner</a> <span class="notes">(64)</span><ul><li><a href="ikkebff0.html?cat=52">Docbook</a> <span class="notes">(7)</span></li>
<li><a href="ikkee864.html?cat=63">Summer of Code 06</a> <span class="notes">(0)</span></li>
</ul>
</li>
<li><a href="ikke8e7f.html?cat=19">Desktop</a> <span class="notes">(93)</span>*</li>
<li><a href="ikke7f33.html?cat=31">Ivman</a> <span class="notes">(3)</span></li>
<li><a href="ikkec055.html?cat=17">Linux</a> <span class="notes">(90)</span></li>
<li><a href="ikke6c5d.html?cat=18">Networks</a> <span class="notes">(14)</span></li>
</ul>
</li>
</ul>
</div>

        <div class="catarc"><h3>Archives</h3><ul><li><a href="ikke/2007/12/index.html">December 2007</a> <span class="dimmed">(2)</span></li>
<li><a href="ikke/2007/11/index.html">November 2007</a> <span class="dimmed">(3)</span></li>
<li><a href="ikke/2007/10/index.html">October 2007</a> <span class="dimmed">(2)</span></li>
<li><a href="ikke/2007/09/index.html">September 2007</a> <span class="dimmed">(3)</span></li>
<li><a href="ikke/2007/08/index.html">August 2007</a> <span class="dimmed">(4)</span></li>
<li><a href="ikke/2007/05/index.html">May  2007</a> <span class="dimmed">(2)</span></li>
<li><a href="ikke/2007/04/index.html">April 2007</a> <span class="dimmed">(4)</span></li>
<li><a href="ikke/2007/03/index.html">March 2007</a> <span class="dimmed">(5)</span></li>
<li><a href="ikke/2007/02/index.html">February 2007</a> <span class="dimmed">(2)</span></li>
<li><a href="ikke/2007/01/index.html">January 2007</a> <span class="dimmed">(3)</span></li>
<li><a href="ikke/2006/07/index.html">July 2006</a> <span class="dimmed">(1)</span></li>
<li><a href="ikke/2006/06/index.html">June 2006</a> <span class="dimmed">(3)</span></li>
<li><a href="ikke1579.html?disp=arcdir">More...</a></li>
</ul>
</div>


	                <div class="catarc">
                <h3 class="sideItemTitle">Who's Online?</h3>
                <ul class="onlineUsers"><li>Guest Users: 426</li></ul>        </div>
        
        <div class="bSideItem">
                <h3>Misc</h3>
                <ul>
                        <li><a href="../htsrv/login32bb.html?redirect_to=http%3A%2F%2Fblog.eikke.com%2Findex.php%2Fikke%3Fblog%3D5%26amp%3Bcat%3D19%26amp%3Bpaged%3D4%26amp%3Bpage%3D1" title="Login if you have an account...">Login...</a></li>                </ul>
        </div>
        <div class="bSideItem">
                <h3><img src="../rsc/icons/feed-icon-16x16.gif" width="16" height="16" class="top" alt="" /> XML Feeds</h3>
                        <ul>
                                <li>
                                        RSS 0.92:
                                        <a href="http://eikke.com/feed/">Posts</a>
                                        <a href="ikke7f88.html?tempskin=_rss&amp;disp=comments">Comments</a>
                                </li>
                                <li>
                                        RSS 1.0:
                                        <a href="http://eikke.com/feed/">Posts</a>
                                        <a href="ikke374e.html?tempskin=_rdf&amp;disp=comments">Comments</a>
                                </li>
                                <li>
                                        RSS 2.0:
                                        <a href="http://eikke.com/feed/">Posts</a>
                                        <a href="ikke6fea.html?tempskin=_rss2&amp;disp=comments">Comments</a>
                                </li>
                                <li>
                                        Atom:
                                        <a href="http://eikke.com/feed/">Posts</a>
                                        <a href="ikke5609.html?tempskin=_atom&amp;disp=comments">Comments</a>
                                </li>
                        </ul>
                        <a href="http://fplanque.net/Blog/itTrends/2004/01/10/rss_rdf_and_atom_in_a_nutshell" title="External - English">What is RSS?</a>
			<div class='bSideItem'><div style='width: 120px; height: 600px; position: relative; left: 25px; padding-bottom: 10px;'>
			<script type="text/javascript"><!--
			google_ad_client = "pub-7170970013053423";
			//blog.eikke.com sidebar onderaan
			google_ad_slot = "7138271274";
			google_ad_width = 120;
			google_ad_height = 600;
			//--></script>
			<script type="text/javascript"
			src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
			</script>
			</div></div>        </div>


        


    </div>
    <!-- Right links column end -->



    </div>
    <!-- #columns end -->

  </div>
  <!-- #page end -->

</div>
<!-- #content end -->




<!-- #footer: holds the site footer (logo and links) -->
<div id="footer">

  <!-- #bg: applies the site width and footer background -->
  <div id="bg" class="width">

    <img src="../skins/nautica05-2col/images/logo.gif" alt="Your logo goes here"/>

    <ul>
      <li><a href="http://b2evolution.net/" title="Powered by b2evolution">b<sub>2</sub>evolution</a></li>
      <li><a href="http://www.brendoman.com/dbc" title="Evoskin by Danny Ferguson">Danny Ferguson</a></li>
      <li><a href="http://www.studio7designs.com/" title="Design by Studio 7 Designs" class="last">studio7designs.com</a></li>
	</ul>

  </div>
  <!-- #bg end -->

</div>
<!-- #footer end -->
</body>


<!-- Mirrored from blog.eikke.com/index.php/ikke?blog=5&cat=19&page=1&paged=4 by HTTrack Website Copier/3.x [XR&CO'2010], Tue, 11 Dec 2012 19:40:38 GMT -->
</html>
