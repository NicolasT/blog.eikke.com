<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">


<!-- Mirrored from blog.eikke.com/index.php/ikke?blog=5&cat=49&page=1&paged=7 by HTTrack Website Copier/3.x [XR&CO'2010], Tue, 11 Dec 2012 19:56:12 GMT -->
<head>
                <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
        <title>Ikke's Blog - Categories: Coding Corner, Docbook, Summer of Code 06</title>
        <base  />        <meta name="description" content="Just my weBlog" />
        <meta name="keywords" content="nicolas trangez ikke eikke blog code linux desktop gnome dbus hal freedesktop ivman css xhtml code dump gallery c programming computing" />
        <meta name="generator" content="b2evolution 1.8.6" /> <!-- Please leave this for stats -->
        <link rel="alternate" type="text/xml" title="RDF" href="http://eikke.com/feed/" />
        <link rel="alternate" type="text/xml" title="RSS .92" href="http://eikke.com/feed/" />
        <link rel="alternate" type="text/xml" title="RSS 2.0" href="http://eikke.com/feed/" />
        <link rel="alternate" type="application/atom+xml" title="Atom" href="http://eikke.com/feed/" />
        <link rel="pingback" href="../xmlsrv/xmlrpc.php" />
  <link rel="stylesheet" type="text/css" href="../skins/nautica05-2col/css/layout.css" media="screen, projection, tv " />
  <link rel="stylesheet" type="text/css" href="../skins/nautica05-2col/css/html.css" media="screen, projection, tv " />

  <!-- CSS specific to current theme -->
  <link rel="stylesheet"           type="text/css" href="../skins/nautica05-2col/css/light.html" title="light" media="screen, projection, tv " />
  <link rel="alternate stylesheet" type="text/css" href="../skins/nautica05-2col/css/dark.html"  title="dark"  media="screen, projection, tv " />
        </head>

<body>

<!-- #content: holds all except site footer - causes footer to stick to bottom -->
<div id="content">

  <!-- #header: holds the logo and top links -->
  <div id="header" class="width">

    <img src="../skins/nautica05-2col/images/logo.gif" alt="Your logo goes here"/>
<ul id="bloglist"><li><a href="all.html" class="BlogButton" title="All Blogs">Blog All</a></li>
<li><a href="ikke.html" class="BlogButtonCurr" title="Ikke&#039;s Blog">Ikke</a></li>
<li><a href="fedorastateless.html" class="BlogButton" title="Fedora Stateless @ UGent">FSU</a></li>
<li><a href="realnitro.html" class="BlogButton" title="RealNitro&#039;s Blog">RealNitro</a></li>
<li><a href="http://peterdedecker.net/blog/index.php" class="BlogButton" title="Peter&#039;s Blog">Peter</a></li>
</ul>
    <!-- Or, comment out the bloglist and add your own links up here
    <ul>
      <li><a href="index.html">Back to Main page</a></li>
      <li><a href="">About us</a></li>
      <li><a href="">Streaming Video</a></li>
      <li><a href="" class="last">RSS Feeds</a></li>
    </ul>-->

  </div>
  <!-- #header end -->


  <!-- #headerImg: holds the main header image or flash -->
  <div id="headerImg" class="width"></div>



  <!-- #menu: the main large box site menu -->
  <div id="menu" class="width">
<!-- More links you could use if you want
    <ul>
      <li>
        <a href="onecol.html" onfocus="blur()">
          <span class="title ">One Column Layout</span>
          <span class="desc">View the included layout</span>        </a>      </li>
      <li>
        <a href="twocol_a.html" class="forum" onfocus="blur()">
          <span class="title ">Two Column Layout A</span>
          <span class="desc style3">View the included layout</span>        </a>      </li>
      <li>
        <a href="twocol_b.html" onfocus="blur()">
          <span class="title ">Two Column Layout B</span>
          <span class="desc">View the included layout</span>
        </a>
      </li>
      <li>
        <a href="contact.html" onfocus="blur()">
          <span class="title ">Contact Us Layout</span>
          <span class="desc">View the included layout</span>
        </a>
      </li>
    </ul>
    -->
  </div>
  <!-- #menu end -->



  <!-- #page: holds the page content -->
  <div id="page">


    <!-- #columns: holds the columns of the page -->
    <div id="columns" class="widthPad">


    <!-- Left column -->
    <div class="floatLeft width73">

<h1 style="margin-top:5px"><span class="dark"><a href="ikke.html">Ikke's Blog</a></span></h1>



<!-- =================================== START OF MAIN AREA =================================== -->

<div class="action_messages"></div>
<h2>Categories: Coding Corner, Docbook, Summer of Code 06</h2>
        <div class="bPost bPostpublished" lang="en-US">
                      <!-- Start Post -->
      <div class="post">

        <div class="date">
          <span class="month">Nov</span>
          <span class="day">3</span>
        </div>
<div class="bPost">
          <span class="title">Using C++ classes in C</span>

                        <p>Today I had a little chat with <a href="http://blogs.gnome.org/portal/michiels" title="Michiel">Michiel</a> on #gnome-nl regarding the use of C++ classes in C code (he started learning C again ;-)).</p>

<p>I was fascinated (well, sort of) by this, and tried to get something working. Here's the result:</p>

<ul><li><p>First we need a C++ class, using one header file (Test.hh)</p>
<pre><code>class Test {
        public:
                void testfunc();
                Test(int i);

        private:
                int testint;
};
</code></pre>
<p>and one implementation file (Test.cc)</p>
<pre><code>#include &lt;iostream&gt;
#include "Test.hh"

using namespace std;

Test::Test(int i) {
        this->testint = i;
}

void Test::testfunc() {
        cout &lt;&lt; "test " &lt;&lt; this->testint &lt;&lt; endl;
}</code></pre>

<p>This is just basic C++ code.</p></li>
<li><p>Then we need some glue code. This code is something in-between C and C++. Again, we got one header file (TestWrapper.h, just .h as it doesn't contain any C++ code)</p>
<pre><code>typedef void CTest;

#ifdef __cplusplus
extern "C" {
#endif
CTest * test_new(int i);
void test_testfunc(const CTest *t);
void test_delete(CTest *t);
#ifdef __cplusplus
}
#endif
</code></pre>
<p>and the function implementations (TestWrapper.cc, .cc as it contains C++ code):</p>
<pre><code>#include "TestWrapper.h"
#include "Test.hh"

extern "C" {

CTest * test_new(int i) {
       Test *t = new Test(i);

       return (CTest *)t;
}

void test_testfunc(const CTest *test) {
        Test *t = (Test *)test;
        t->testfunc();
}

void test_delete(CTest *test) {
        Test *t = (Test *)test;

        delete t;
}
}
</code></pre>

<p>Some things you should notice:</p>
<ol><li><code>typedef void CTest</code><br />
We typedef CTest to void. This way we can use "CTest *" in our C code as if it's a normal C type, whilst we have compile-time type checks (sort of at least  :-)), and it's cleaner than always using "void *"</li><br />
<li><p>The use of "extern "C" { }" around all functions (both definitions and implementations). We need this so the compiler won't <a href="http://en.wikipedia.org/wiki/Name_mangling#Name_mangling_in_C.2B.2B" title="name-mangle">name-mangle</a> the resulting binaries. If you want to see what name-mangling is:</p>
<pre>$ cat test.c
#include &lt;iostream&gt;
using namespace std;

void test() {
        cout &lt;&lt; "test" &lt;&lt; endl;
}

int main(int argc, char *argv[]) {
        test();
        return 0;
}
$ g++ -o nmtest test.c
$ ./nmtest
test
$ nm nmtest
***blablabla***
08048818 t _Z41__static_initialization_and_destruction_0ii
080487c4 T _Z4testv
         U _ZNKSs4sizeEv@@GLIBCXX_3.4
         U _ZNKSsixEj@@GLIBCXX_3.4
***blablabla***</pre>
<p>As you can see, our "test()" function has been renamed to "_Z4testv" by the compiler. This is needed to allow polyphormism in C++, but we don't want this in our C wrapper of course, as we want to know the name of the function we will call!<br />
This implies we need another function name for every polyphormistic (SP?) class function of our C++ class in the C wrapper.</p></li></ol>
</li>
<li><p>At last, we need some code to test our work (main.c):</p>
<pre><code>#include &lt;stdio.h&gt;
#include "TestWrapper.h"

int main() {
        CTest *t = NULL;

        t = test_new(5);
        test_testfunc(t);
        test_delete(t);
        t = NULL;

        return 0;
}
</code></pre>
<p>This is, once more, braindead simple (C) code, where we use the functions defined in TestWrapper.h.</p>
</li>
<li><p>Last but not least, we need to compile everything. I made a basic Makefile to do this (Makefile):</p>
<pre>CFLAGS=-Wall -Werror -g -ansi -pedantic -std=c89
CCFLAGS=-Wall -Werror -g
LDFLAGS=-g -Wall -lstdc++

OBJS=Test.o TestWrapper.o main.o
PROG=test

all: $(PROG)
default: all

%.o: %.cc
        $(CC) $(CCFLAGS) -c $&lt;

%.o: %.c
        $(CC) $(CFLAGS) -c $&lt;

$(PROG): $(OBJS)
        $(CC) $(OBJS) $(LDFLAGS) -o $@

clean:
        rm -f $(OBJS)
        rm -f $(PROG)
</pre>
</li></ul>
<p>Now we can simply call "make" to build the project:</p>
<pre>$ make
cc -Wall -Werror -g -c Test.cc
cc -Wall -Werror -g -c TestWrapper.cc
cc -Wall -Werror -g -ansi -pedantic -std=c89 -c main.c
cc Test.o TestWrapper.o main.o -g -Wall -lstdc++ -o test</pre>
<p>Finally, we test the resulting binary:</p>
<pre>$ ./test
test 5</pre>
<p>which is the expected result.</p>

<p>Obviously, writing a wrapper like this by hand can be a boring task. It might be possible to automate/script this, but I don't know whether the result is worth the time one puts into it. Just use plain C, we don't need C++ ;-)</p>                              <!-- End Post -->
                  <div><script type="text/javascript"><!--
      google_ad_client = "pub-7170970013053423";
      //blog.eikke.com links
      google_ad_slot = "9622796794";
      google_ad_width = 468;
      google_ad_height = 15;
      //--></script>
      <script type="text/javascript"
      src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
      </script></div>
                      <div class="bSmallPrint">
                        Ikke &bull; <a href="ikke3f99.html?cat=16" title="Browse category">Technology</a>, <strong><a href="ikke3cd0.html?cat=49" title="Browse category">Coding Corner</a></strong><a href="ikke/2005/11/03/using_c_classes_in_c.html" title="Permanent link to full entry" class="permalink_right"><img src="../rsc/icons/minipost.gif" border="0" align="top" width="12" height="9"  class="middle" alt="Permalink"/></a>
                        <a href="ikke/2005/11/03/using_c_classes_in_c.html#comments" title="Display comments / Leave a comment">2 comments</a>                                                                        
                        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
  rdf:about="http://blog.eikke.com/index.php/ikke/2005/11/03/using_c_classes_in_c"
  dc:identifier="http://blog.eikke.com/index.php/ikke/2005/11/03/using_c_classes_in_c"
  dc:title="Using C++ classes in C"
  trackback:ping="http://blog.eikke.com/htsrv/trackback.php/420" />
</rdf:RDF>-->
                </div>
</div>
                        </div>
      </div>
                <div class="bPost bPostpublished" lang="en-US">
                      <!-- Start Post -->
      <div class="post">

        <div class="date">
          <span class="month">Nov</span>
          <span class="day">3</span>
        </div>
<div class="bPost">
          <span class="title">Scratchbox working</span>

                        <p>Thanks to Bram (and <a href="http://www.vtk.ugent.be/" title="VTK">VTK</a> Computer) I got an old 20Gb hard drive, which I needed to be able to install a <a href="http://www.scratchbox.org/" title="Scratchbox">Scratchbox</a> environment and play around with the <a href="http://www.maemo.org/" title="Maemo">Maemo</a> platform.<br />
I managed to install everything by now (although I had one <a href="http://forums.gentoo.org/viewtopic-t-386131-highlight-.html" title="crash">crash</a> again :-(), so I hope I'll be able to start hacking on some apps/libs soon. One of the things I'd love to get working is <a href="http://www.freedesktop.org/Software/Avahi" title="Avahi">Avahi</a>, the GPL'ed mDNS stack.</p>

<p>The obligatory shot:<br />
<center><img src="http://www.eikke.com/files/maemo-scratchbox-xephyr.png" title="Maemo Scratchbox Xephyr" /></center></p>

<p>I just followed <a href="http://maemo.org/platform/docs/tutorials/Maemo_tutorial.html#settingup" title="these">these</a> steps. They contain one error though: when editing your ~/.bash_profile, you got to add a line containing<br />
<center><code>export LC_ALL=en_GB</code></center><br />
too.</p>                              <!-- End Post -->
                            <div class="bSmallPrint">
                        Ikke &bull; <strong><a href="ikke3f99.html?cat=16" title="Browse category">Technology</a></strong>, <a href="ikkec055.html?cat=17" title="Browse category">Linux</a>, <a href="ikke8e7f.html?cat=19" title="Browse category">Desktop</a>, <a href="ikke3cd0.html?cat=49" title="Browse category">Coding Corner</a><a href="ikke/2005/11/03/scratchbox_working.html" title="Permanent link to full entry" class="permalink_right"><img src="../rsc/icons/minipost.gif" border="0" align="top" width="12" height="9"  class="middle" alt="Permalink"/></a>
                        <a href="ikke/2005/11/03/scratchbox_working.html#comments" title="Display comments / Leave a comment">3 comments</a>                                                                        
                        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
  rdf:about="http://blog.eikke.com/index.php/ikke/2005/11/03/scratchbox_working"
  dc:identifier="http://blog.eikke.com/index.php/ikke/2005/11/03/scratchbox_working"
  dc:title="Scratchbox working"
  trackback:ping="http://blog.eikke.com/htsrv/trackback.php/419" />
</rdf:RDF>-->
                </div>
</div>
                        </div>
      </div>
                <div class="bPost bPostpublished" lang="en-US">
                      <!-- Start Post -->
      <div class="post">

        <div class="date">
          <span class="month">Sep</span>
          <span class="day">19</span>
        </div>
<div class="bPost">
          <span class="title">Dislocated wrist, and GIM update</span>

                        <p>Typing this using one hand, as I was so stupid to dislocate my left wrist last saturday night. At least, I <em>hope</em> it's only dislocated, and not broken. And <b>yes</b>, it does hurt.<br />
I might get a picture later.<br />
Got some GIM design drawings completed lately, but only on paper, I need to dia'ize them (which won't be an easy job now). I hope I'll be able to show some of the work soon.</p>                              <!-- End Post -->
                            <div class="bSmallPrint">
                        Ikke &bull; <strong><a href="ikkeb5e7.html?cat=15" title="Browse category">Life</a></strong>, <a href="ikke3f99.html?cat=16" title="Browse category">Technology</a>, <a href="ikke3cd0.html?cat=49" title="Browse category">Coding Corner</a><a href="ikke/2005/09/19/dislocated_wrist_and_gim_update.html" title="Permanent link to full entry" class="permalink_right"><img src="../rsc/icons/minipost.gif" border="0" align="top" width="12" height="9"  class="middle" alt="Permalink"/></a>
                        <a href="ikke/2005/09/19/dislocated_wrist_and_gim_update.html#comments" title="Display comments / Leave a comment">3 comments</a>                                                                        
                        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
  rdf:about="http://blog.eikke.com/index.php/ikke/2005/09/19/dislocated_wrist_and_gim_update"
  dc:identifier="http://blog.eikke.com/index.php/ikke/2005/09/19/dislocated_wrist_and_gim_update"
  dc:title="Dislocated wrist, and GIM update"
  trackback:ping="http://blog.eikke.com/htsrv/trackback.php/411" />
</rdf:RDF>-->
                </div>
</div>
                        </div>
      </div>
                <div class="bPost bPostpublished" lang="en-US">
                      <!-- Start Post -->
      <div class="post">

        <div class="date">
          <span class="month">Jul</span>
          <span class="day">16</span>
        </div>
<div class="bPost">
          <span class="title">GConf introduction</span>

                        <p>I played a little with GConf today. Here's some little introduction to it.</p>

<p>We'll be doing 3 very simple things today:</p>
<ol><li>Read out GConf key values</li><br />
<li>Set key values</li><br />
<li>Read out values, and register to value changes</li></ol>

<h2>Reading out a string from the GConf tree</h2>
<p>Reading out a value (in our case a string) is very simple: first of all you need to know which string you want to read. In this sample we'll try to get the value of the default browser. Then you create a GConfClient, a proxy to the GConf system, you query gconfd using the proxy, get the value and do something with it.</p>

<p>Here's the code:</p>
<pre><code>/* GConf test reader
 * Compile using
 *      gcc `pkg-config --libs --cflags gconf-2.0` -o reader reader.c
 */

#include &lt;glib.h&gt;
#include &lt;gconf/gconf-client.h&gt;

/* Path to the key we'll be working with */
#define GCKEY "/desktop/gnome/applications/browser/exec"

gint main(gint argc, gchar *argv[]) {
        /* Our proxy */
        GConfClient *gclient = NULL;
        /* String to store the GCKEY's value in */
        gchar *val = NULL;

        /* Initialize the GConf subsystem */
        gconf_init(argc, argv, NULL);

        g_print("Working with key \"%s\"\n", "" GCKEY);
        
        /* Get the default GConf proxy */
        gclient = gconf_client_get_default();
        g_assert(gclient != NULL);

        /* Get the value of GCKEY */
        val = gconf_client_get_string(gclient, "" GCKEY, NULL);
        if(val == NULL) {
                /* Key was not set before */
                val = g_strdup("&lt;unset&gt;");
        }
        g_assert(val != NULL);

        g_print("Value: \"%s\"\n", val);

        g_free(val);

        return 0;
}</code></pre>

<p>As you can see this is very straight-forward.<br />
Now compile and run the code:</p>
<p>ikke@marslander ~/Projects/gconf $ gcc `pkg-config --libs --cflags gconf-2.0` -o reader reader.c<br />
ikke@marslander ~/Projects/gconf $ ./reader<br />
Working with key "/desktop/gnome/applications/browser/exec"<br />
Value: "mozilla"</p>

<h2>Setting a key value</h2>
<p>To set a key, once more we just need a GConfClient proxy, and call a function to set the new key value:</p>
<pre><code>/* GConf test writer
 * Compile using
 *      gcc `pkg-config --libs --cflags gconf-2.0` -o setkey setkey.c
 */

#include &lt;glib.h&gt;
#include &lt;gconf/gconf-client.h&gt;

/* Path to the key we'll be working with */
#define GCKEY "/extra/test/key"

gint main(gint argc, gchar *argv[]) {
        /* Our proxy */
        GConfClient *gclient = NULL;
        /* New value */
        gchar *val = NULL;

        /* Initialize the GConf subsystem */
        gconf_init(argc, argv, NULL);

        if(argc > 1) {
                val = g_strdup(argv[1]);
        }
        else {
                val = g_strdup("testval");
        }

        g_print("Working with key \"%s\"\n", "" GCKEY);
        
        /* Get the default GConf proxy */
        gclient = gconf_client_get_default();
        g_assert(gclient != NULL);

        g_assert(val != NULL);
        gconf_client_set_string(gclient, "" GCKEY, val, NULL);

        g_print("Value \"%s\" set\n", val);

        g_free(val);

        return 0;
}</code></pre>

<p>Again, compile the code and play around with it:</p>
<p>ikke@marslander ~/Projects/gconf $ gcc `pkg-config --libs --cflags gconf-2.0` -o setkey setkey.c<br />
ikke@marslander ~/Projects/gconf $ ./setkey<br />
Working with key "/extra/test/key"<br />
Value "testval" set<br />
ikke@marslander ~/Projects/gconf $ ./setkey test2<br />
Working with key "/extra/test/key"<br />
Value "test2" set</p>

<p>Now you might want to alter reader.c and compile it again so it reads out this new key instead of the one we used before.</p>

<h2>Using change notifications</h2>
<p>At last we'll be using one of the more advanced features of GConf, change notifications. This means we can register a callback to a key change, so when the key's value is changed (in-process or by another process) we'll be notified of this.<br />
One again this is very easy: get a GConfClient proxy, figure out to which key you want to subscribe, find out the container directory, tell gconfd you want to register to that "directory", add a key change event handler, and you're done. This might sound confusing, read the code sample to see how easy it is.</p>

<pre><code>/* GConf test listener
 * Compile using
 *      gcc `pkg-config --libs --cflags gconf-2.0` -o listener listener.c
 */

#include &lt;glib.h&gt;
#include &lt;gconf/gconf-client.h&gt;

/* The GConf PATH we'll want to monitor */
#define GCPATH "/extra/test"
/* Path to the key we'll be working with */
#define GCKEY "/extra/test/key"

/* This is the callback function for GCKEY changes */
void key_changed_cb(GConfClient* client, guint cnxn_id, GConfEntry *entry, gpointer user_data) {
        /* Store the new key value */
        gchar *val = NULL;
        /* A local GConfValue */
        GConfValue *value = NULL;

        /* Get the value from the provided entry */
        value = gconf_entry_get_value(entry);
        
        /* This should not happen, but one never knows */
        if(value == NULL) {
                val = g_strdup("&lt;unset&gt;");
        }
        else {
                /* Check value type, we want a string */
                if(value->type == GCONF_VALUE_STRING) {
                        /* Get the key value
                         * We use g_strdup because we'll g_free(val) later */
                        val = g_strdup(gconf_value_get_string(value));
                }
                else {
                        val = g_strdup("&lt;wrong type&gt;");
                }
        }
        g_assert(val != NULL);

        g_print("Value changed: \"%s\"\n", val);

        g_free(val);
}

gint main(gint argc, gchar *argv[]) {
        /* Our proxy */
        GConfClient *gclient = NULL;
        /* String to store the GCKEY's value in */
        gchar *val = NULL;
        /* A simple mainloop */
        GMainLoop *loop = NULL;

        /* Initialize the GConf subsystem */
        gconf_init(argc, argv, NULL);

        g_print("Working with key \"%s\"\n", "" GCKEY);
        
        /* Get the default GConf proxy */
        gclient = gconf_client_get_default();
        g_assert(gclient != NULL);

        /* Get the value of GCKEY */
        val = gconf_client_get_string(gclient, "" GCKEY, NULL);
        if(val == NULL) {
                /* Key was not set before */
                val = g_strdup("&lt;unset&gt;");
        }
        g_assert(val != NULL);

        g_print("Initial value: \"%s\"\n", val);

        g_free(val);

        /* Watch GCPATH */
        gconf_client_add_dir(gclient, "" GCPATH, GCONF_CLIENT_PRELOAD_NONE, NULL);
        /* And specify a callback function for GCKEY changes */
        gconf_client_notify_add(gclient, "" GCKEY, key_changed_cb, NULL, NULL, NULL);

        /* Create a mainloop and run it */
        loop = g_main_loop_new(NULL, FALSE);
        g_assert(loop != NULL);
        g_main_loop_run(loop);

        return 0;
}</code></pre>

<p>50% of this code is equal to "reader.c". The only "special" things is adding a callback notifier in main(), and the callback function itself.<br />
You should notice GConfValues got a type: in this sample we check whether the key's type equals to "GCONF_VALUE_STRING", otherwise we don't "process" the value.</p>

<p>Once more, compile and run this code:</p>
<p>ikke@marslander ~/Projects/gconf $ gcc `pkg-config --libs --cflags gconf-2.0` -o listener listener.c<br />
ikke@marslander ~/Projects/gconf $ ./listener<br />
Working with key "/extra/test/key"<br />
Initial value: "test2"</p>
<p>At this point, the program just hangs due to our GMainLoop. The key value is the one last set with ./setkey</p>

<p>Now open a new console, go to the directory where setkey is located, and execute it giving some new value. Then watch what's going on at the terminal where "listener" is running:</p>
<p>ikke@marslander ~/Projects/gconf $ ./setkey "a longer test key"<br />
Working with key "/extra/test/key"<br />
Value "a longer test key" set</p>
<p>In the "listener" console, we see this:</p>
<p>Value changed: "a longer test key"</p>
<p>Jay, change notifications working fine :-)</p>

<p>In this sample we only worked with string values, GConf also supports floats, integers, booleans, lists and even more. Check out the <a href="http://developer.gnome.org/doc/API/gconf/index.html" title="API docs">API docs</a> for more information.<br />
If you want to read more about GConf, e.g. its internals, you might want to check <a href="http://developer.gnome.org/feature/archive/gconf/gconf.html" title="this tutorial">this tutorial</a> by the GConf author, Havoc Pennington. Notice this is an old document, so the code samples in there won't work anymore, the GConf API has changed quite a lot since then. The ideas explained in the article are still relevant though, so it's worth reading.</p>                              <!-- End Post -->
                            <div class="bSmallPrint">
                        Ikke &bull; <a href="ikke8e7f.html?cat=19" title="Browse category">Desktop</a>, <strong><a href="ikke3cd0.html?cat=49" title="Browse category">Coding Corner</a></strong><a href="ikke/2005/07/16/gconf_introduction.html" title="Permanent link to full entry" class="permalink_right"><img src="../rsc/icons/minipost.gif" border="0" align="top" width="12" height="9"  class="middle" alt="Permalink"/></a>
                        <a href="ikke/2005/07/16/gconf_introduction.html#comments" title="Display comments / Leave a comment">3 comments</a>                                                                        
                        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
  rdf:about="http://blog.eikke.com/index.php/ikke/2005/07/16/gconf_introduction"
  dc:identifier="http://blog.eikke.com/index.php/ikke/2005/07/16/gconf_introduction"
  dc:title="GConf introduction"
  trackback:ping="http://blog.eikke.com/htsrv/trackback.php/333" />
</rdf:RDF>-->
                </div>
</div>
                        </div>
      </div>
                <div class="bPost bPostpublished" lang="en-US">
                      <!-- Start Post -->
      <div class="post">

        <div class="date">
          <span class="month">Jun</span>
          <span class="day">15</span>
        </div>
<div class="bPost">
          <span class="title">Gnome tip</span>

                        <p><a href="http://gnometux.blogspot.com/2005/06/quick-screenshotting.html" title="This">This</a> must be the greates Gnome tip I ever read (the dragging part at least). Now finally one doesn't need to crawl through one Save and one Open dialog to send a simple screenshot to some buddy. Thanks Karel!!!</p>

<p>Next to that: <a href="http://www.masswerk.at/jsuix/" title="this">this</a> is some of the most insane projects ever. A Unix shell written in JavaScript, that can be run from a browser. Check the "Open Shell" link on top of the page. Pretty nifty, didn't look at the code yet, will do that later.</p>

<p>Started working on the "save and restore enabled plugins" functionality today. I decided to use GMarkup instead of libxml2 so I don't add another dependency (next to glib), and the config strings are so easy formatted GMarkup is more than sufficient to parse them. But it made me discover once more how much I hate dreaded SAX parsing. Someone who enjoys writing SAX based parsers must be on a serious crack overdose :crazy:</p>                              <!-- End Post -->
                            <div class="bSmallPrint">
                        Ikke &bull; <a href="ikkec055.html?cat=17" title="Browse category">Linux</a>, <strong><a href="ikke8e7f.html?cat=19" title="Browse category">Desktop</a></strong>, <a href="ikke3cd0.html?cat=49" title="Browse category">Coding Corner</a><a href="ikke/2005/06/15/gnome_tip.html" title="Permanent link to full entry" class="permalink_right"><img src="../rsc/icons/minipost.gif" border="0" align="top" width="12" height="9"  class="middle" alt="Permalink"/></a>
                        <a href="ikke/2005/06/15/gnome_tip.html#comments" title="Display comments / Leave a comment">2 comments</a>                                                                        
                        <!--
<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" 
  xmlns:dc="http://purl.org/dc/elements/1.1/"
  xmlns:trackback="http://madskills.com/public/xml/rss/module/trackback/">
<rdf:Description
  rdf:about="http://blog.eikke.com/index.php/ikke/2005/06/15/gnome_tip"
  dc:identifier="http://blog.eikke.com/index.php/ikke/2005/06/15/gnome_tip"
  dc:title="Gnome tip"
  trackback:ping="http://blog.eikke.com/htsrv/trackback.php/234" />
</rdf:RDF>-->
                </div>
</div>
                        </div>
      </div>
        
        <p class="center"><strong>
                <a href="ikke5485.html?blog=5&amp;cat=49&amp;page=1&amp;paged=6">&lt;&lt; Previous Page</a> :: <a href="ikke5d46.html?blog=5&amp;cat=49&amp;page=1&amp;paged=8">Next Page &gt;&gt;</a>                 </strong></p>

    </div>
    <!-- Left column end -->


    <!-- Right link column -->
    <div class="floatRight width25 lightBlueBg horzPad">
               <div class="bSideItem">
                <form action="http://blog.eikke.com/index.php/ikke" method="get" name="SearchForm" class="search">                        <p><input type="text" name="s" size="23" value="" class="SearchField" /><br />
                        <input type="submit" name="submit" class="submit" value="Search" style="margin-top:3px" /></p>
                </form>
        </div>
		<div class="bSideItem">
	<div style='position: relative; left: 25px;'>
	<script type="text/javascript"><!--
	google_ad_client = "pub-7170970013053423";
	//Ikke&#39;s blog
	google_ad_slot = "5340725895";
	google_ad_width = 120;
	google_ad_height = 240;
	//--></script>
	<script type="text/javascript"
	src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
	</script></div>
		</div>
              <div class="catarc"><h3>Categories</h3><ul><li><a href="ikke.html">All</a></li>
<li><a href="ikkeb5e7.html?cat=15">Life</a> <span class="notes">(56)</span></li>
<li><a href="ikke3f99.html?cat=16">Technology</a> <span class="notes">(131)</span><ul><li><a href="ikke3cd0.html?cat=49">Coding Corner</a> <span class="notes">(64)</span>*<ul><li><a href="ikkebff0.html?cat=52">Docbook</a> <span class="notes">(7)</span>*</li>
<li><a href="ikkee864.html?cat=63">Summer of Code 06</a> <span class="notes">(0)</span>*</li>
</ul>
</li>
<li><a href="ikke8e7f.html?cat=19">Desktop</a> <span class="notes">(93)</span></li>
<li><a href="ikke7f33.html?cat=31">Ivman</a> <span class="notes">(3)</span></li>
<li><a href="ikkec055.html?cat=17">Linux</a> <span class="notes">(90)</span></li>
<li><a href="ikke6c5d.html?cat=18">Networks</a> <span class="notes">(14)</span></li>
</ul>
</li>
</ul>
</div>

        <div class="catarc"><h3>Archives</h3><ul><li><a href="ikke/2007/12/index.html">December 2007</a> <span class="dimmed">(2)</span></li>
<li><a href="ikke/2007/11/index.html">November 2007</a> <span class="dimmed">(3)</span></li>
<li><a href="ikke/2007/10/index.html">October 2007</a> <span class="dimmed">(2)</span></li>
<li><a href="ikke/2007/09/index.html">September 2007</a> <span class="dimmed">(3)</span></li>
<li><a href="ikke/2007/08/index.html">August 2007</a> <span class="dimmed">(4)</span></li>
<li><a href="ikke/2007/05/index.html">May  2007</a> <span class="dimmed">(2)</span></li>
<li><a href="ikke/2007/04/index.html">April 2007</a> <span class="dimmed">(4)</span></li>
<li><a href="ikke/2007/03/index.html">March 2007</a> <span class="dimmed">(5)</span></li>
<li><a href="ikke/2007/02/index.html">February 2007</a> <span class="dimmed">(2)</span></li>
<li><a href="ikke/2007/01/index.html">January 2007</a> <span class="dimmed">(3)</span></li>
<li><a href="ikke/2006/07/index.html">July 2006</a> <span class="dimmed">(1)</span></li>
<li><a href="ikke/2006/06/index.html">June 2006</a> <span class="dimmed">(3)</span></li>
<li><a href="ikke1579.html?disp=arcdir">More...</a></li>
</ul>
</div>


	                <div class="catarc">
                <h3 class="sideItemTitle">Who's Online?</h3>
                <ul class="onlineUsers"><li>Guest Users: 227</li></ul>        </div>
        
        <div class="bSideItem">
                <h3>Misc</h3>
                <ul>
                        <li><a href="../htsrv/login2b68.html?redirect_to=http%3A%2F%2Fblog.eikke.com%2Findex.php%2Fikke%3Fblog%3D5%26amp%3Bcat%3D49%26amp%3Bpaged%3D7%26amp%3Bpage%3D1" title="Login if you have an account...">Login...</a></li>                </ul>
        </div>
        <div class="bSideItem">
                <h3><img src="../rsc/icons/feed-icon-16x16.gif" width="16" height="16" class="top" alt="" /> XML Feeds</h3>
                        <ul>
                                <li>
                                        RSS 0.92:
                                        <a href="http://eikke.com/feed/">Posts</a>
                                        <a href="ikke7f88.html?tempskin=_rss&amp;disp=comments">Comments</a>
                                </li>
                                <li>
                                        RSS 1.0:
                                        <a href="http://eikke.com/feed/">Posts</a>
                                        <a href="ikke374e.html?tempskin=_rdf&amp;disp=comments">Comments</a>
                                </li>
                                <li>
                                        RSS 2.0:
                                        <a href="http://eikke.com/feed/">Posts</a>
                                        <a href="ikke6fea.html?tempskin=_rss2&amp;disp=comments">Comments</a>
                                </li>
                                <li>
                                        Atom:
                                        <a href="http://eikke.com/feed/">Posts</a>
                                        <a href="ikke5609.html?tempskin=_atom&amp;disp=comments">Comments</a>
                                </li>
                        </ul>
                        <a href="http://fplanque.net/Blog/itTrends/2004/01/10/rss_rdf_and_atom_in_a_nutshell" title="External - English">What is RSS?</a>
			<div class='bSideItem'><div style='width: 120px; height: 600px; position: relative; left: 25px; padding-bottom: 10px;'>
			<script type="text/javascript"><!--
			google_ad_client = "pub-7170970013053423";
			//blog.eikke.com sidebar onderaan
			google_ad_slot = "7138271274";
			google_ad_width = 120;
			google_ad_height = 600;
			//--></script>
			<script type="text/javascript"
			src="http://pagead2.googlesyndication.com/pagead/show_ads.js">
			</script>
			</div></div>        </div>


        


    </div>
    <!-- Right links column end -->



    </div>
    <!-- #columns end -->

  </div>
  <!-- #page end -->

</div>
<!-- #content end -->




<!-- #footer: holds the site footer (logo and links) -->
<div id="footer">

  <!-- #bg: applies the site width and footer background -->
  <div id="bg" class="width">

    <img src="../skins/nautica05-2col/images/logo.gif" alt="Your logo goes here"/>

    <ul>
      <li><a href="http://b2evolution.net/" title="Powered by b2evolution">b<sub>2</sub>evolution</a></li>
      <li><a href="http://www.brendoman.com/dbc" title="Evoskin by Danny Ferguson">Danny Ferguson</a></li>
      <li><a href="http://www.studio7designs.com/" title="Design by Studio 7 Designs" class="last">studio7designs.com</a></li>
	</ul>

  </div>
  <!-- #bg end -->

</div>
<!-- #footer end -->
</body>


<!-- Mirrored from blog.eikke.com/index.php/ikke?blog=5&cat=49&page=1&paged=7 by HTTrack Website Copier/3.x [XR&CO'2010], Tue, 11 Dec 2012 19:56:13 GMT -->
</html>
