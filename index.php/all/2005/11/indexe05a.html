<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US" lang="en-US">

<!-- Mirrored from blog.eikke.com/index.php/all/2005/11/?blog=1&m=200511 by HTTrack Website Copier/3.x [XR&CO'2010], Tue, 11 Dec 2012 19:46:56 GMT -->
<head> 
	<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<title>
	All Blogs - Archives for: November 2005</title>
<base  />
<meta name="description" content="" />
<meta name="keywords" content="ikke eikke blog" />
<meta name="generator" content="b2evolution 1.8.6" /> <!-- Please leave this for stats -->
<link rel="alternate" type="text/xml" title="RDF" href="http://eikke.com/feed/" />
<link rel="alternate" type="text/xml" title="RSS .92" href="http://eikke.com/feed/" />
<link rel="alternate" type="text/xml" title="RSS 2.0" href="http://eikke.com/feed/" />
<link rel="alternate" type="application/atom+xml" title="Atom" href="http://eikke.com/feed/" />
<link rel="pingback" href="../../../../xmlsrv/xmlrpc.php" />
<link rel="stylesheet" href="../../../../skins/plain/style.css" type="text/css" />

</head>

<body>
<a name="top" id="top"></a>
<center>
		<div id="menu">
				<a href="../../../all.html" title="The blog front page">home</a>
<a href="../../../../htsrv/logine7a5.html?redirect_to=http%3A%2F%2Fblog.eikke.com%2Findex.php%2Fall%2F2005%2F11%2F%3Fblog%3D1%26amp%3Bm%3D200511" title="Login if you have an account...">Login...</a>
<a href="../../../all03a1.html?disp=comments">Last comments</a>
		</div>
		
		<div id="header">


      <h1><a href="../../../all.html" style="border:0px;">All Blogs</a></h1>
      <h2></h2>
		</div>
		
		<div id="content">
		
				
				<div id="sidebar">
<div class="submenu">
<div class="boxTop">&nbsp;</div><div class="menuBox"><a href="../../../all.html" class="menuItem" title="All Blogs">Blog All</a>
<a href="../../../ikke.html" class="menuItem" title="Ikke&#039;s Blog">Ikke</a>
<a href="../../../fedorastateless.html" class="menuItem" title="Fedora Stateless @ UGent">FSU</a>
<a href="../../../realnitro.html" class="menuItem" title="RealNitro&#039;s Blog">RealNitro</a>
<a href="http://peterdedecker.net/blog/index.php" class="menuItem" title="Peter&#039;s Blog">Peter</a>
</div></div>

		<p></p>
<div class="postBox"><div class="boxTop">Categories</div><h4><a href="../../../all.html">All Blogs</a></h4>
<h4><a href="../../../ikke.html">Ikke's Blog</a></h4>
<ul><li><a href="../../../allb5e7.html?cat=15">Life</a> <span class="notes">(56)</span></li>
<li><a href="../../../all3f99.html?cat=16">Technology</a> <span class="notes">(131)</span><ul><li><a href="../../../all3cd0.html?cat=49">Coding Corner</a> <span class="notes">(64)</span><ul><li><a href="../../../allbff0.html?cat=52">Docbook</a> <span class="notes">(7)</span></li>
<li><a href="../../../alle864.html?cat=63">Summer of Code 06</a> <span class="notes">(0)</span></li>
</ul>
</li>
<li><a href="../../../all8e7f.html?cat=19">Desktop</a> <span class="notes">(93)</span></li>
<li><a href="../../../all7f33.html?cat=31">Ivman</a> <span class="notes">(3)</span></li>
<li><a href="../../../allc055.html?cat=17">Linux</a> <span class="notes">(90)</span></li>
<li><a href="../../../all6c5d.html?cat=18">Networks</a> <span class="notes">(14)</span></li>
</ul>
</li>
</ul>
<h4><a href="../../../fedorastateless.html">Fedora Stateless @ UGent</a></h4>
<ul><li><a href="../../../allede2.html?cat=32">General</a> <span class="notes">(10)</span></li>
<li><a href="../../../allb97c.html?cat=30">Nifty solutions</a> <span class="notes">(3)</span></li>
<li><a href="../../../allaeb3.html?cat=29">Problems we encounter</a> <span class="notes">(9)</span></li>
<li><a href="../../../allb60a.html?cat=27">Project status and progress</a> <span class="notes">(13)</span></li>
</ul>
<h4><a href="../../../realnitro.html">RealNitro's Blog</a></h4>
<ul><li><a href="../../../alld11d.html?cat=54">Coding</a> <span class="notes">(9)</span></li>
<li><a href="../../../allc733.html?cat=38">Fun</a> <span class="notes">(2)</span></li>
<li><a href="../../../all97dc.html?cat=33">Gaming</a> <span class="notes">(4)</span><ul><li><a href="../../../all9ad7.html?cat=35">CUBE</a> <span class="notes">(3)</span></li>
<li><a href="../../../all9591.html?cat=37">Max Payne</a> <span class="notes">(0)</span></li>
<li><a href="../../../alla88f.html?cat=36">RTCW:ET</a> <span class="notes">(2)</span></li>
</ul>
</li>
<li><a href="../../../allf528.html?cat=47">Life</a> <span class="notes">(11)</span></li>
<li><a href="../../../all8dbd.html?cat=50">Linux</a> <span class="notes">(7)</span></li>
<li><a href="../../../all489b.html?cat=34">Webdesign</a> <span class="notes">(4)</span></li>
</ul>
<h4><a href="http://peterdedecker.net/blog/index.php">Peter's Blog</a></h4>
<ul><li><a href="../../../all363a.html?cat=45">Free Software</a> <span class="notes">(9)</span><ul><li><a href="../../../allb0b4.html?cat=48">Jabber</a> <span class="notes">(4)</span></li>
<li><a href="../../../all51fa.html?cat=40">Linux</a> <span class="notes">(9)</span><ul><li><a href="../../../allffca.html?cat=41">My Gentoo</a> <span class="notes">(19)</span></li>
<li><a href="../../../allf170.html?cat=53">Ubuntu@AMD64</a> <span class="notes">(4)</span></li>
</ul>
</li>
<li><a href="../../../all434a.html?cat=57">Workgroup Free Software</a> <span class="notes">(4)</span></li>
</ul>
</li>
<li><a href="../../../alle7dd.html?cat=59">Internet &amp; Blogs</a> <span class="notes">(12)</span></li>
<li><a href="../../../alle8fb.html?cat=39">Life &amp; Fun</a> <span class="notes">(47)</span></li>
<li><a href="../../../all1e3b.html?cat=55">Politics</a> <span class="notes">(16)</span><ul><li><a href="../../../allfa15.html?cat=51">EU Software Patents</a> <span class="notes">(8)</span></li>
<li><a href="../../../all848d.html?cat=58">N-VA</a> <span class="notes">(4)</span></li>
</ul>
</li>
<li><a href="../../../all667c.html?cat=43">Studies</a> <span class="notes">(23)</span><ul><li><a href="../../../all493d.html?cat=62">Siemens</a> <span class="notes">(13)</span></li>
</ul>
</li>
<li><a href="../../../alle868.html?cat=60">UGent &amp; Stuver</a> <span class="notes">(18)</span></li>
<li><a href="../../../allac94.html?cat=42">VTK</a> <span class="notes">(10)</span></li>
</ul>

</div>
<div class="boxTop"><a href="../../../all03a1.html?disp=comments">Last comments</a></div>
<div class="postBox">	

  <ul>
<li>- louboutin on <a href="../../../ikke/2005/12/23/crosswords.html#c11861" title="permalink to comment">Crosswords</a>

</li>
<li>- rhinestone motif on <a href="../../../ikke/2005/11/19/ooo2_on_770.html#c11860" title="permalink to comment">OOo2 on 770</a>

</li>
<li>- richard on <a href="../../../ikke/2007/05/08/openoffice_rant.html#c11859" title="permalink to comment">OpenOffice rant</a>

</li>
<li>- Tom on <a href="../../../ikke/2005/01/31/gob_signals_walkthrough.html#c11858" title="permalink to comment">GOB signals walkthrough</a>

</li>
<li>- Tom on <a href="../../../ikke/2005/01/31/gob_signals_walkthrough.html#c11857" title="permalink to comment">GOB signals walkthrough</a>

</li>
        </ul>
</div>

<div class="postBox"><table class="bCalendarTable" cellspacing="0" summary="Monthly calendar with links to each day's posts">
<caption class="bCalendarCaption"><a href="index.html" title="go to month's archive">November 2005</a></caption>
<thead><tr class="bCalendarRow">
<th class="bCalendarHeaderCell" abbr="Sunday" scope="col" title="Sunday">Sun</th>
<th class="bCalendarHeaderCell" abbr="Monday" scope="col" title="Monday">Mon</th>
<th class="bCalendarHeaderCell" abbr="Tuesday" scope="col" title="Tuesday">Tue</th>
<th class="bCalendarHeaderCell" abbr="Wednesday" scope="col" title="Wednesday">Wed</th>
<th class="bCalendarHeaderCell" abbr="Thursday" scope="col" title="Thursday">Thu</th>
<th class="bCalendarHeaderCell" abbr="Friday" scope="col" title="Friday">Fri</th>
<th class="bCalendarHeaderCell" abbr="Saturday" scope="col" title="Saturday">Sat</th>
</tr></thead>
<tfoot>
<tr>
<td colspan="2" id="prev"><a href="../../2004/11/index.html" title="Previous year (2004-11)">&lt;&lt;</a>&nbsp;<a href="../10/index.html" title="Previous month (2005-10)">&lt;</a></td>
<td colspan="3" class="center"><a href="../../2012/12/index.html">Current</a></td><td colspan="2" id="next">&nbsp;<a href="../12/index.html" title="Next month (2005-12)">&gt;</a>&nbsp;<a href="../../2006/10/index.html" title="Next year (2006-10)">&gt;&gt;</a></td>
</tr>
</tfoot>
<tr class="bCalendarRow">
<td class="bCalendarEmptyCell">&nbsp;</td>
<td class="bCalendarEmptyCell">&nbsp;</td>
<td class="bCalendarCell">1</td>
<td class="bCalendarCell">2</td>
<td class="bCalendarLinkPost"><a href="03/index.html" title="2 posts">3</a></td>
<td class="bCalendarCell">4</td>
<td class="bCalendarLinkPost"><a href="05/index.html" title="1 post">5</a></td>
</tr>
<tr class="bCalendarRow">
<td class="bCalendarCell">6</td>
<td class="bCalendarCell">7</td>
<td class="bCalendarCell">8</td>
<td class="bCalendarCell">9</td>
<td class="bCalendarCell">10</td>
<td class="bCalendarCell">11</td>
<td class="bCalendarLinkPost"><a href="12/index.html" title="1 post">12</a></td>
</tr>
<tr class="bCalendarRow">
<td class="bCalendarLinkPost"><a href="13/index.html" title="1 post">13</a></td>
<td class="bCalendarCell">14</td>
<td class="bCalendarCell">15</td>
<td class="bCalendarCell">16</td>
<td class="bCalendarLinkPost"><a href="17/index.html" title="1 post">17</a></td>
<td class="bCalendarCell">18</td>
<td class="bCalendarLinkPost"><a href="19/index.html" title="3 posts">19</a></td>
</tr>
<tr class="bCalendarRow">
<td class="bCalendarCell">20</td>
<td class="bCalendarCell">21</td>
<td class="bCalendarCell">22</td>
<td class="bCalendarLinkPost"><a href="23/index.html" title="1 post">23</a></td>
<td class="bCalendarCell">24</td>
<td class="bCalendarLinkPost"><a href="25/index.html" title="1 post">25</a></td>
<td class="bCalendarCell">26</td>
</tr>
<tr class="bCalendarRow">
<td class="bCalendarCell">27</td>
<td class="bCalendarCell">28</td>
<td class="bCalendarCell">29</td>
<td class="bCalendarCell">30</td>
<td class="bCalendarEmptyCell">&nbsp;</td>
<td class="bCalendarEmptyCell">&nbsp;</td>
<td class="bCalendarEmptyCell">&nbsp;</td>
</tr>
</table></div>
<div class="postBox"><div class="boxTop">Archives</div><ul><li><a href="../../2007/12/index.html">December 2007</a> <span class="dimmed">(2)</span></li>
<li><a href="../../2007/11/index.html">November 2007</a> <span class="dimmed">(3)</span></li>
<li><a href="../../2007/10/index.html">October 2007</a> <span class="dimmed">(2)</span></li>
<li><a href="../../2007/09/index.html">September 2007</a> <span class="dimmed">(3)</span></li>
<li><a href="../../2007/08/index.html">August 2007</a> <span class="dimmed">(4)</span></li>
<li><a href="../../2007/05/index.html">May  2007</a> <span class="dimmed">(2)</span></li>
<li><a href="../../2007/04/index.html">April 2007</a> <span class="dimmed">(4)</span></li>
<li><a href="../../2007/03/index.html">March 2007</a> <span class="dimmed">(5)</span></li>
<li><a href="../../2007/02/index.html">February 2007</a> <span class="dimmed">(2)</span></li>
<li><a href="../../2007/01/index.html">January 2007</a> <span class="dimmed">(3)</span></li>
<li><a href="../../2006/10/index.html">October 2006</a> <span class="dimmed">(2)</span></li>
<li><a href="../../2006/08/index.html">August 2006</a> <span class="dimmed">(1)</span></li>
<li><a href="../../../all1579.html?disp=arcdir">More...</a></li>
</ul>
</div>

<!-- =============== SEARCH BOX ======================== --> 
<div class="boxTop">Search</div>
<div class="postBox"><form action="http://blog.eikke.com/index.php/all" method="get" id="searchform">	<br />	<div align="center"><input class="search" size="15" name="s" /><br />
        <input type="submit" value="Search" name="submit" class="btn"  />
        </div>
</form>
</div>
<div class="postBox">
<h3 class="boxTop">Who's Online?</h3>
	<ul class="onlineUsers"><li>Guest Users: 421</li></ul>	</div>

			
<div class="boxTop">Syndicate this blog <img src="../../../../img/xml.html" alt="XML" width="36" height="14" class="middle" /></div>               
	<div class="postBox">
RSS 0.92: <a href="http://eikke.com/feed/">Posts</a>, <a href="../../../all7f88.html?tempskin=_rss&amp;disp=comments">Comments</a>
<br />
RSS 1.0: <a href="http://eikke.com/feed/">Posts</a>, <a href="../../../all374e.html?tempskin=_rdf&amp;disp=comments">Comments</a>
<br />
RSS 2.0: <a href="http://eikke.com/feed/">Posts</a>, <a href="../../../all6fea.html?tempskin=_rss2&amp;disp=comments">Comments</a>
<br />
Atom: <a href="http://eikke.com/feed/">Posts</a>, <a href="../../../all5609.html?tempskin=_atom&amp;disp=comments">Comments</a>
</div>		

<!-- Menu footer -->
<br /> <div align="center">powered by<br />
<a href="http://b2evolution.net/" title="b2evolution home"><img src="../../../../img/b2evolution_logo_80.html" alt="b2evolution" width="80" height="17" border="0" class="middle" /></a></div>
				</div>
						
						
				<div id="mainbar">

<h2>Archives for: November <a href="../index.html">2005</a></h2><!-- 
== START OF MAIN AREA
====== -->

<h2>11/25/05</h2><div class="bPost" lang="en-US">
		<div class="title">Spam attack</div>
	<div class="bText">
		<p>This blog is under a massive referer spam attack at the moment by multiple spambots. I'm trying to get rid of them using .htaccess, but it hardly works.<br />
Those spambots already consumed all my monthly bandwith, so I really need them to go away. If someone knows how to do this (I googled around, no usable help), please let me know asap, otherwise I'll be forced to take this blog down for some days I'm afraid... Maybe I should switch to WordPress here too.</p>

<p>My sincere apologies if I broke something in the blog setup, or if some people are unable to reach the site although they're not spammers.</p>			</div>
         <div class="bSmallPrint">
	  <a href="../../../ikke/2005/11/25/spam_attack.html" title="Permanent link to full entry" class="permalink_right"><img src="../../../../skins/plain/images/chain_link.gif" alt="Permalink" width="14" height="14" border="0" class="middle" /></a>
	  .
          <a href="../../../all7441.html?author=" title="Browse all posts by this author">Ikke</a>

          .
	  11:24:29 am	  .

          109 Words          .
	  
	<a href="../../../ikke3f99.html?cat=16" title="true">Technology</a>  
	.
		.
	389 views	
	 . <a href="../../../ikke/2005/11/25/spam_attack.html#comments" title="Display comments / Leave a comment">6 comments</a>	  	</div>
	</div>
<h2>11/23/05</h2><div class="bPost" lang="en-US">
		<div class="title">Non-tech people on tech stuff</div>
	<div class="bText">
		<p><a href="http://blogs.gnome.org/view/rodrigo/2005/11/23/0" target="_blank">Read this.</a></p>

<p>Reminds me on an article on "Web 2.0" in our newspaper some days ago, and a "readers reaction" on it yesterday. Obviously 2 people who don't understand what it's all about. Sadly enough.</p>			</div>
         <div class="bSmallPrint">
	  <a href="../../../ikke/2005/11/23/non_tech_people_on_tech_stuff.html" title="Permanent link to full entry" class="permalink_right"><img src="../../../../skins/plain/images/chain_link.gif" alt="Permalink" width="14" height="14" border="0" class="middle" /></a>
	  .
          <a href="../../../all7441.html?author=" title="Browse all posts by this author">Ikke</a>

          .
	  01:31:34 pm	  .

          33 Words          .
	  
	<a href="../../../ikkeb5e7.html?cat=15" title="true">Life</a>, <a href="../../../ikkec055.html?cat=17" title="true">Linux</a>  
	.
		.
	477 views	
	 . <a href="../../../ikke/2005/11/23/non_tech_people_on_tech_stuff.html#comments" title="Display comments / Leave a comment">3 comments</a>	  	</div>
	</div>
<h2>11/19/05</h2><div class="bPost" lang="en-US">
		<div class="title">OOo2 on 770</div>
	<div class="bText">
		<p><a href="../../../realnitro/2005/11/19/remote_x_on_nokia_770_schreenshots.html" title="Nice work">Nice work</a>, <a href="http://www.realnitro.be/" title="RealNitro">RealNitro</a>!</p>			</div>
         <div class="bSmallPrint">
	  <a href="../../../ikke/2005/11/19/ooo2_on_770.html" title="Permanent link to full entry" class="permalink_right"><img src="../../../../skins/plain/images/chain_link.gif" alt="Permalink" width="14" height="14" border="0" class="middle" /></a>
	  .
          <a href="../../../all7441.html?author=" title="Browse all posts by this author">Ikke</a>

          .
	  09:17:00 pm	  .

          23 Words          .
	  
	<a href="../../../ikke8e7f.html?cat=19" title="true">Desktop</a>  
	.
		.
	1059 views	
	 . <a href="../../../ikke/2005/11/19/ooo2_on_770.html#comments" title="Display comments / Leave a comment">5 comments</a>	  	</div>
	</div>
<div class="bPost" lang="nl-BE">
		<div class="title">Remote X on Nokia 770: schreenshots</div>
	<div class="bText">
		<p>Due to the fact that the <a href="http://koti.welho.com/jpavelek/tmp/770/" title="screenshot tool">screenshot tool</a> had a bug at the time I gave remote X windows a try on the N770, I could't post any 'proof'.</p>

<p>But, that screenshot-bug has been solved, and I connected my N770 to the fresh install of <a href="http://ubuntulinux.org/" title="Ubuntu Linux">Ubuntu Linux</a> so I could take shoot some screens. It took me about 4 minutes to make my N770 talk to the pc (Ubuntu recognised my usb bluetooth key immediately, it really wasn't hard at all). I installed the openssh-server on the pc (enabled it in Synaptic, and pressed Apply, easy stuff), started it, and logged in with my N770.</p>

<p>This time I used some new command line options (thank you <a href="../../../realnitro/2005/11/17/remote_x_sessions_on_nokia_770.html#c3544" title="daf">daf</a>):</p>
<blockquote><p><code>ssh -X user@server -c blowfish -C</code></p></blockquote>
<p>And I started <a href="http://www.openoffice.org/" title="oowriter2">oowriter2</a> again:<br />
<center><img src="http://www.realnitro.be/files/screens/n770_ooo_1_small.png" alt="oowriter2 starting..." title="oowriter2 starting..." /><br />
(<a href="http://www.realnitro.be/files/screens/n770_ooo_1.png" title="Larger image">Larger image</a>)</center></p>

<p>and a few seconds later (the pc is quite old):</p>

<p><center><img src="http://www.realnitro.be/files/screens/n770_ooo_2_small.png" alt="oowriter2 on N770" title="oowriter2 on N770" /><br />
(<a href="http://www.realnitro.be/files/screens/n770_ooo_2.png" title="Larger image">Larger image</a>)</center></p>

<p>Then I gave The Gimp another try, but the lag was still there. It was better a bit faster than without the compression settings for the ssh connection, but nowhere near usable. :-(</p>

<p>btw, has anyone tried <a href="http://shop.brando.com.hk/btsmartkeyboard.php" title="this keyboard">this keyboard</a> with the N770 yet? Does it work? Or should/will it work? Plz let me know!</p>			</div>
         <div class="bSmallPrint">
	  <a href="../../../realnitro/2005/11/19/remote_x_on_nokia_770_schreenshots.html" title="Permanent link to full entry" class="permalink_right"><img src="../../../../skins/plain/images/chain_link.gif" alt="Permalink" width="14" height="14" border="0" class="middle" /></a>
	  .
          <a href="../../../all7441.html?author=" title="Browse all posts by this author">RealNitro</a>

          .
	  19:54:46	  .

          261 Words          .
	  
	<a href="../../../realnitrod11d.html?cat=54" title="true">Coding</a>  
	.
	 <a href="../../../allc300.html?disp=msgform&amp;recipient_id=9&amp;post_id=426&amp;redirect_to=http%3A%2F%2Fblog.eikke.com%2Findex.php%2Fall%2F2005%2F11%2F%3Fblog%3D1%26amp%3Bm%3D200511%26amp%3Bpage%3D1" title="Send email to post author"><img src="../../../../rsc/icons/envelope.gif" border="0" align="top" width="13" height="10"  class="middle" title="Send email to post author" alt="Email"/></a> 	.
	1229 views	
		  	</div>
	</div>
<div class="bPost" lang="en-US">
		<div class="title">Small Valgrind introduction</div>
	<div class="bText">
		<p>Everyone writing C or C++ code should know what a memory leak is. You allocate some memory, and never free it.<br />
It can be very hard to make your code memleak free, or even just to know whether your code contains any memleaks.<br />
Luckily, in the Free Software world, we got a great tool to check our code for memleaks (or other errors): <a href="http://valgrind.org/" title="Valgrind">Valgrind</a>.</p>

<p>As I don't have time to write a lot now, I'll just give a very simple sample of it's usage.</p>

<p>Here's my code (very bad code, obviously, but hey ;-)):</p>
<pre><code>#include &lt;stdio.h&gt;
#include &lt;stdlib.h&gt;

static void function() {
        char *test = (char *)malloc(100 * sizeof(char));
        test[0] = '\0';

        printf("Function\n");

        /* Leaking 100 chars here, 100 bytes */
}

int main(int argc, char *argv[]) {
        int *i = NULL;

        function();
        i = (int *)malloc(50 * sizeof(int));
        printf("Done\n");

        return 0;

        /* Leaking 50 ints here. On x86, this is 50*4=200 bytes */
}
</code></pre>
<p>As you can see, we leak memory twice: once 100 bytes, once 200.<br />
Let's compile and run our code:</p>
<pre>$ gcc -o test -Wall -g test.c
$ ./test
Function
Done</pre>
<p>Great, our code works fine (or at least, it looks like it).</p>

<p>Now we introduce valgrind. First we'll do a simple memory allocation check:</p>
<pre>$ valgrind --tool=memcheck ./test ==18819== Memcheck, a memory error detector for x86-linux.
==18819== Copyright (C) 2002-2004, and GNU GPL'd, by Julian Seward et al.
==18819== Using valgrind-2.2.0, a program supervision framework for x86-linux.
==18819== Copyright (C) 2000-2004, and GNU GPL'd, by Julian Seward et al.
==18819== For more details, rerun with: -v
==18819==
Function
Done
==18819==
==18819== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 13 from 1)
==18819== malloc/free: in use at exit: 300 bytes in 2 blocks.
==18819== malloc/free: 2 allocs, 0 frees, 300 bytes allocated.
==18819== For a detailed leak analysis,  rerun with: --leak-check=yes
==18819== For counts of detected errors, rerun with: -v</pre>
<p>Valgrind tells us we leaked 300 bytes, in 2 blocks (one malloc call returns one block, obviously).<br />
It also tells us to re-run the test with the --leak-check=yes flag, which is a good advice:</p>
<pre>$ valgrind --tool=memcheck --leak-check=yes ./test
==18826== Memcheck, a memory error detector for x86-linux.
==18826== Copyright (C) 2002-2004, and GNU GPL'd, by Julian Seward et al.
==18826== Using valgrind-2.2.0, a program supervision framework for x86-linux.
==18826== Copyright (C) 2000-2004, and GNU GPL'd, by Julian Seward et al.
==18826== For more details, rerun with: -v
==18826==
Function
Done
==18826==
==18826== ERROR SUMMARY: 0 errors from 0 contexts (suppressed: 13 from 1)
==18826== malloc/free: in use at exit: 300 bytes in 2 blocks.
==18826== malloc/free: 2 allocs, 0 frees, 300 bytes allocated.
==18826== For counts of detected errors, rerun with: -v
==18826== searching for pointers to 2 not-freed blocks.
==18826== checked 1404368 bytes.
==18826==
==18826== 100 bytes in 1 blocks are definitely lost in loss record 1 of 2
==18826==    at 0x1B906B82: malloc (vg_replace_malloc.c:131)
==18826==    by 0x80483B5: function (test.c:5)
==18826==    by 0x80483F4: main (test.c:14)
==18826==
==18826==
==18826== 200 bytes in 1 blocks are definitely lost in loss record 2 of 2
==18826==    at 0x1B906B82: malloc (vg_replace_malloc.c:131)
==18826==    by 0x8048400: main (test.c:15)
==18826==
==18826== LEAK SUMMARY:
==18826==    definitely lost: 300 bytes in 2 blocks.
==18826==    possibly lost:   0 bytes in 0 blocks.
==18826==    still reachable: 0 bytes in 0 blocks.
==18826==         suppressed: 0 bytes in 0 blocks.
==18826== Reachable blocks (those to which a pointer was found) are not shown.
==18826== To see them, rerun with: --show-reachable=yes</pre>
<p>Great, here Valgrind tells us exactly what we're doing wrong.<br />
There are 2 blocks where we leak memory:</p>
<ul><li><p>The first one is at code path<br />
main (test.c:14) -> function (test.c:5) -> malloc (vg_replace_malloc.c:131)<br />
leaking 100 bytes.<br />
The vg_replace_malloc.c file isn't ours, it's a valgrind file where the malloc() wrapper (which keeps track of our allocations/free's/...) is located. We're mostly interested in the "function (test.c:5)" part. If we look at line 5, we see this is</p>
<pre><code>char *test = (char *)malloc(100 * sizeof(char));</code></pre>our first allocation. And indeed, if we look further, we never free these 100 chars.</li>
<li>Second is at main (test.c:15). Again, we can look at this line:<pre><code>i = (int *)malloc(50 * sizeof(int));</code></pre>and indeed, we never free these allocated integers again. We allocated 50 ints, and on x86 one int is 32 bits (4 bytes), so we leak 200 bytes (and valgrind was correct once again :-)).</li></ul>
<p>Obviously, valgrind got much more options or checks:</p>
<pre>$ valgrind
valgrind: Missing --tool option
Available tools:
        memcheck
        addrcheck
        cachegrind
        corecheck
        helgrind
        massif
        lackey
        none
        callgrind
valgrind: Use --help for more information.</pre><p>I don't know all of them, actually I only use the memcheck thing, but even when only using one tool, it can be a very useful program.</p>

<p>I got one minor issue with valgrind currently: when it detects memory leaks in some program, it still returns 0 in the end, so it's not easy to integrate valgrind checks in automake's "make check" target. If someone got any pointers how to do this, please let me know!</p>			</div>
         <div class="bSmallPrint">
	  <a href="../../../ikke/2005/11/19/small_valgrind_introduction.html" title="Permanent link to full entry" class="permalink_right"><img src="../../../../skins/plain/images/chain_link.gif" alt="Permalink" width="14" height="14" border="0" class="middle" /></a>
	  .
          <a href="../../../all7441.html?author=" title="Browse all posts by this author">Ikke</a>

          .
	  03:53:33 pm	  .

          761 Words          .
	  
	<a href="../../../ikkec055.html?cat=17" title="true">Linux</a>, <a href="../../../ikke3cd0.html?cat=49" title="true">Coding Corner</a>  
	.
		.
	2159 views	
	 . <a href="../../../ikke/2005/11/19/small_valgrind_introduction.html#comments" title="Display comments / Leave a comment">13 comments</a>	  	</div>
	</div>
<h2>11/17/05</h2><div class="bPost" lang="en-EU">
		<div class="title">Remote X sessions on Nokia 770</div>
	<div class="bText">
		<p><a href="http://www.internettablettalk.com/forums/showthread.php?t=361&amp;page=1&amp;pp=10" title="Some topics">Some topics</a> on <a href="http://www.internettablettalk.com/" title="internettablettalk.com">internettablettalk.com</a> have great views on what the N770 might have to offer in the future. One nice possibility is forwarding X sessions to a N770. I started with forwarding Gedit from my pc to my N770, but later on I had a go at 'oowriter2' (OpenOffice.org 2 Writer), Supertux and The Gimp. My experiences about those apps on the N770 are at the end of this post. First I'll tell you how to try it yourself.</p>

<p>Some basic requirements:</p>

<ul>
  <li>a computer running the X-server and sshd (a decent linux box ;-) )</li>
  <li>a (fast) network connection between your N770 and the server</li>
  <li>openSSH for the maemo platform</li>
</ul>
<p>To install openSSH on your N770, download the <a href="http://repository.maemo.org/pool/maemo1.1rc6/free/o/openssh/" title="openSSH">openSSH</a> .deb package to your N770. Next,open an <a href="http://770.fs-security.com/xterm/" title="X-terminal">X-terminal</a>, and <a href="http://maemo.org/maemowiki/HowDoiBecomeRoot" title="gain root access">gain root access</a>. If the .deb openSSH package is on your mmc, navigate to it:</p>
<blockquote><p><code>cd /media/mmc1/</code></p></blockquote>
<p>And install openSSH (it doesn't install using the graphical package installer):</p>
<blockquote><p><code>dpkg -x ssh_*.deb /</code></p></blockquote>

<p>Caution: make sure that your servers sshd allows X forwarding! Time to connect to the server:</p>
<blockquote><p><code>ssh -X user@server</code></p></blockquote>
<p>Change user to your login-name, and change server to your servers IP or domain name. The first time you log into your server from your N770, ssh wil ask you a question. Answer 'yes'. Then it will ask your password. Enter it. You should get a command prompt as 'user' on your server. Time to execute a program! I use the <a href="http://www.gnome.org/" title="Gnome">Gnome</a> desktop environment, and the default text editor (like notepad in Windows -- but waaay better ;-) ) in Gnome is Gedit. The command to start Gedit from a terminal is 'gedit' (duh! :-p ). Execute</p>
<blockquote><p><code>gedit</code></p></blockquote>
<p>Give it some time to start, and you'll see Gedit running on your N770! To try any other programs, just tap their commands into the terminal and have fun!</p>

<p>But there are a few downsides. The first big downside is text-input: The onscreen-keyboard does not appear when you put the cursor inside a text-field of an X-forwarded window. Copy-pasting text is possible though. Maybe people with working Bluetooth keyboards will be able to type some text. Is somebody willing to try? One other downside is that X-forwarded windows vanish when they are minimized. There seems to be no way to get them back, killing the parent program and restarting it is the only solution. (You can kill the parent program by bringing your X-term back up, opening 'X Terminal'->'Terminal'->'Send Ctrl-some key', and tapping the 'c' keyboard button.) The fullscreen button didn't work aswell. Gedit just doesn't recognise/receive the signal emited by that fullscreen button, I guess.</p>

<p>Beside those little anoyances, Gedit ran quite smooth. So I decided to start the OpenOffice.org 2 Writer. And it worked too! The gui wasn't 100% snappy (i.e. scrolling was laggy), but it seemed fast enough to be usable. Later that day, I decided to give Supertux a try. (Supertux is a Super Mario clone.) The verdict: not playable. The <a href="../../../realnitro/2005/11/13/sharing_internet_with_nokia_770_over_blu.html" title="bluetooth connection">bluetooth connection</a> between my pc and my N770 just wasn't fast enough to transfer all that graphical goodness without (a LOT of) lag. The Gimp suffers from the same problem. Drawing with your stylus is possible, but the result lags several seconds behind.</p>

<p>A possible solution for the lag problems would be to compress the data that's being sent between the X-server and the client (your N770). A FreeNX-client would be great as the NX protocol is in fact a compressed (and secured) forwarded X-session. (FreeNX is a free alternative to <a href="http://www.nomachine.com/" title="NoMachine NX">NoMachine NX</a>.) </p>			</div>
         <div class="bSmallPrint">
	  <a href="../../../realnitro/2005/11/17/remote_x_sessions_on_nokia_770.html" title="Permanent link to full entry" class="permalink_right"><img src="../../../../skins/plain/images/chain_link.gif" alt="Permalink" width="14" height="14" border="0" class="middle" /></a>
	  .
          <a href="../../../all7441.html?author=" title="Browse all posts by this author">RealNitro</a>

          .
	  21:31:01	  .

          658 Words          .
	  
	<a href="../../../realnitro8dbd.html?cat=50" title="true">Linux</a>, <a href="../../../realnitrod11d.html?cat=54" title="true">Coding</a>  
	.
	 <a href="../../../allbc00.html?disp=msgform&amp;recipient_id=9&amp;post_id=424&amp;redirect_to=http%3A%2F%2Fblog.eikke.com%2Findex.php%2Fall%2F2005%2F11%2F%3Fblog%3D1%26amp%3Bm%3D200511%26amp%3Bpage%3D1" title="Send email to post author"><img src="../../../../rsc/icons/envelope.gif" border="0" align="top" width="13" height="10"  class="middle" title="Send email to post author" alt="Email"/></a> 	.
	2280 views	
		  	</div>
	</div>
<h2>11/13/05</h2><div class="bPost" lang="en-EU">
		<div class="title">Sharing internet with Nokia 770 over bluetooth</div>
	<div class="bText">
		<p>It's been a (very) long time since I have posted here (again), but I bought myself a Nokia 770 last week, and it took me a lot of time to get it on the net, so I thought I'd share how I got it to work.</p>

<p>First off, some interesting links:</p>
<ul>
  <li><a href="http://gentoo-wiki.com/HOWTO_The_host-to-host_Bluetooth" title="Host to host bluetooth on the gentoo wiki">Host to host bluetooth on the gentoo wiki</a></li>
  <li><a href="http://maemo.org/maemowiki/HowDoiBecomeRoot" title="Enable root access on the maemo wiki">Enable root access on the maemo wiki</a></li>
  <li><a href="http://maemo.org/maemowiki/HOWTO-BluetoothNetworking" title="Bluetooth networking howto on the Maemo wiki">Bluetooth networking howto on the Maemo wiki</a></li>
  <li><a href="http://770.fs-security.com/xterm/" title="X Terminal for the Nokia 770">X Terminal for the Nokia 770</a></li>
  <li><a href="http://www.tldp.org/HOWTO/IP-Masquerade-HOWTO/" title="IP Masquerade howto">IP Masquerade howto</a></li>
</ul>

<p>You need to have your bluetooth stick working first. Gentoo users should read the first parts of the <a href="http://gentoo-wiki.com/HOWTO_The_host-to-host_Bluetooth" title="host to host bluetooth">host to host bluetooth</a> howto, other distro's should consult the proper information on the community forums/wiki. (Don't scan for other devices yet, just setup your kernel and BlueZ.)</p>

<p>Then open the <a href="http://770.fs-security.com/xterm/" title="X Terminal">X Terminal</a> on your 770 and <a href="http://maemo.org/maemowiki/HowDoiBecomeRoot" title="be root">be root</a>. Enter:</p>
<blockquote><p><code>hcitool scan</code></p></blockquote>
<p>The scan should display your pc's bluetooth name and its bluetooth ID. If the scan cannot find your computer, check again if your bluetooth stick is really working. Scanning for your 770 on your computer is no use, since your 770 will remain invisible.  Now let's pair your 770 with the pc. Execute the following on your 770, but replace 00:10:20:30:40:50 with your computer's Bluetooth ID:</p>
<blockquote><p><code>hcitool cc 00:10:20:30:40:50</code></p></blockquote>
<p>If you get an error, try:</p>
<blockquote><p><code>rm /etc/bluetooth/link_key</code></p></blockquote>
<p>If the pairing works, you will be asked to enter the PIN code of your pc. There is no need to try to connect from your pc to your 770, it will not work anyway (your pc cannot see your 770, remember). Next, make your computer listen for an incoming (network) connection. As root execute:</p>
<blockquote><p><code>pand --listen --role NAP</code></p></blockquote>
<p>Now, on your 770, connect to your pc:</p>
<blockquote><p><code>pand --connect 00:10:20:30:40:50</code></p></blockquote>
<p>(Replace 00:10:20:30:40:50 with your pc's Bluetooth ID again.)</p>

<p>If the connection has been set up, the following command should work on your 770:</p>
<blockquote><p><code>ifconfig bnep0 192.168.2.2 netmask 255.255.255.0 broadcast 192.168.2.255</code></p></blockquote>
<p>Warning: if your local network already uses the 192.168.2.* subnet, replace the IP with another one that isn't in a subnet your pc is a part of!<br />
On your pc, execute the same command, but change the IP:</p>
<blockquote><p><code>ifconfig bnep0 192.168.2.1 netmask 255.255.255.0 broadcast 192.168.2.255</code></p></blockquote>

<p>We're almost there now. Your 770 and your pc are part of the same subnet now! Let's try to ping the 770. On your pc:</p>
<blockquote><p><code>ping 192.168.2.2</code></p></blockquote>
<p>If you installed the <a href="http://maemo.org/maemowiki/InstallSsh" title="ssh server">ssh server</a>, you can run it now, and log into it from your pc.</p>

<p>Now, let's set up the internet connection forwarding. First off, let your 770 know that your pc is its gateway to the internet:</p>
<blockquote><p><code>route add default gw 192.168.2.1</code></p></blockquote>
<p>Also add a dummy internet connection:</p>
<blockquote><p><code>gconftool -s -t string /system/osso/connectivity/IAP/DEFAULT/type DUMMY</code></p></blockquote>
<p>On your pc, display the content of /etc/resolv.conf:</p>
<blockquote><p><code>cat /etc/resolv.conf</code></p></blockquote>
<p>And add the rules to the /etc/resolv.conf file on your 770. For each line do:</p>
<blockquote><p><code>echo "line" >> /etc/resolv.conf</code></p></blockquote>

<p>All that's left to do is making your pc act as a router for your 770. One way to do that (not the easiest one), is to use a program called <em>iptables</em>. In this howto I will explain how to setup iptables on gentoo. Again, if you use an other distro, check the community forums and/or wiki. On gentoo, emerge iptables. You might have to recompile your kernel, just follow the 'Kernel Support' chapter of <a href="http://gentoo-wiki.com/HOWTO_Iptables_for_newbies" title="this howto">this howto</a> on the gentoo wiki. To configure iptables, you can read <a href="http://www.tldp.org/HOWTO/IP-Masquerade-HOWTO/" title="this guide">this guide</a>, or, if you just want a quick solution, use <a href="http://www.tldp.org/HOWTO/IP-Masquerade-HOWTO/firewall-examples.html#RC.FIREWALL-IPTABLES" title="this script">this script</a>. As root, paste it inside a file. Then comment out <em>IPTABLES=/usr/local/sbin/iptables</em>, and uncomment <em>#IPTABLES=/sbin/iptables</em>. Change <em>INTIF="eth1"</em> to <em>INTIF="bnep0"</em>. You might have to change <em>EXTIF="eth0"</em> too. (I had to change it to vpnlink because I connect to the internet with a vpn.) When you finished changing the script, make it executable, and run it. There <em>should</em> be no errors. Now save the script:</p>
<blockquote><p><code>/etc/init.d/iptables save</code></p></blockquote>
<p>and start iptables:</p>
<blockquote><p><code>/etc/init.d/iptables start</code></p></blockquote>
<p>If you want to start iptables everytime you boot, do:</p>
<blockquote><p>rc-update add iptables default</p></blockquote>

<p>You should be able to surf with your 770 now! I plan on writing a few script to make the linking more automatic. Plz share your comments here, and post any mistakes in the howto.</p>			</div>
         <div class="bSmallPrint">
	  <a href="../../../realnitro/2005/11/13/sharing_internet_with_nokia_770_over_blu.html" title="Permanent link to full entry" class="permalink_right"><img src="../../../../skins/plain/images/chain_link.gif" alt="Permalink" width="14" height="14" border="0" class="middle" /></a>
	  .
          <a href="../../../all7441.html?author=" title="Browse all posts by this author">RealNitro</a>

          .
	  20:05:28	  .

          807 Words          .
	  
	<a href="../../../realnitro8dbd.html?cat=50" title="true">Linux</a>, <a href="../../../realnitrod11d.html?cat=54" title="true">Coding</a>  
	.
	 <a href="../../../all32f7.html?disp=msgform&amp;recipient_id=9&amp;post_id=423&amp;redirect_to=http%3A%2F%2Fblog.eikke.com%2Findex.php%2Fall%2F2005%2F11%2F%3Fblog%3D1%26amp%3Bm%3D200511%26amp%3Bpage%3D1" title="Send email to post author"><img src="../../../../rsc/icons/envelope.gif" border="0" align="top" width="13" height="10"  class="middle" title="Send email to post author" alt="Email"/></a> 	.
	3197 views	
		  	</div>
	</div>
<h2>11/12/05</h2><div class="bPost" lang="en-US">
		<div class="title">Nano on Maemo</div>
	<div class="bText">
		<p>So, you got <a href="http://maemo.org/maemowiki/InstallSsh" title="SSH access">SSH access</a> to your <a href="http://www.nokia.com/770" title="Nokia 770">Nokia 770</a>, but can't edit any files? Try <a href="http://www.eikke.com/files/maemo-nano_1.2.5-1_arm.deb" title="my">my</a> <a href="http://www.nano-editor.org/" title="Nano">Nano</a> package...<br />
It doesn't work yet in the <a href="http://maemo.org/maemowiki/ApplicationCatalog#head-63fdb5829e44b95e94f65ccd4507699cb9aa86ea" title="xterm">xterm</a> application (I didn't try myself yet, RealNitro told me ;-)), looks like there's some issue with that terminal's CTRL-key emulation...<br />
Anyway, it's meant to be used over SSH, not for on-device purposes...</p>

<p>Now I still should be able to get USB networking working somehow :-( Didn't spend any more time on it though...</p>			</div>
         <div class="bSmallPrint">
	  <a href="../../../ikke/2005/11/12/nano_on_maemo.html" title="Permanent link to full entry" class="permalink_right"><img src="../../../../skins/plain/images/chain_link.gif" alt="Permalink" width="14" height="14" border="0" class="middle" /></a>
	  .
          <a href="../../../all7441.html?author=" title="Browse all posts by this author">Ikke</a>

          .
	  10:25:42 pm	  .

          121 Words          .
	  
	<a href="../../../ikke3f99.html?cat=16" title="true">Technology</a>, <a href="../../../ikke8e7f.html?cat=19" title="true">Desktop</a>  
	.
		.
	436 views	
	 . <a href="../../../ikke/2005/11/12/nano_on_maemo.html#comments" title="Display comments / Leave a comment">10 comments</a>	  	</div>
	</div>
<h2>11/05/05</h2><div class="bPost" lang="en-US">
		<div class="title">Maemo and mDNS</div>
	<div class="bText">
		<p>Porting <a href="http://www.freedesktop.org/Software/Avahi" title="Avahi">Avahi</a> to the <a href="http://www.maemo.org/" title="Maemo">Maemo</a> platform seems to be quite hard (if not impossible) because of the <a href="http://www.freedesktop.org/Software/dbus" title="DBUS">DBUS</a> version conflict (Avahi needs DBUS >= 0.34, whilst the Maemo platform is still based on DBUS 0.2x). There's a DBUS 0.3x branch in Maemo's SVN repository, but that's not stable yet, and will only be used in the InternetTablet2006 releases, so I gave up on Avahi for now :oops:.<br />
Instead, I'm trying to create a good package of <a href="http://www.porchdogsoft.com/products/howl/" title="Howl">Howl</a> now (I know, I don't like the <a href="http://www.porchdogsoft.com/products/howl/docs/index.html" title="Howl API">Howl API</a> either), then I'll attempt to build a small (Hildon?) application on top of it, just as a test case for "the real thing" ;-)</p>

<p>*edit*<br />
It works inside my scratchbox (i386) :-)<br />
Built an arm deb package too, installed it on my "real" device, the software runs (no ld errors), but I couldnt test it yet as I don't have a wireless network at home, and didn't manage to get USB networking working yet :-(</p>			</div>
         <div class="bSmallPrint">
	  <a href="../../../ikke/2005/11/05/maemo_and_mdns.html" title="Permanent link to full entry" class="permalink_right"><img src="../../../../skins/plain/images/chain_link.gif" alt="Permalink" width="14" height="14" border="0" class="middle" /></a>
	  .
          <a href="../../../all7441.html?author=" title="Browse all posts by this author">Ikke</a>

          .
	  07:25:18 pm	  .

          197 Words          .
	  
	<a href="../../../ikke3f99.html?cat=16" title="true">Technology</a>, <a href="../../../ikkec055.html?cat=17" title="true">Linux</a>, <a href="../../../ikke6c5d.html?cat=18" title="true">Networks</a>, <a href="../../../ikke3cd0.html?cat=49" title="true">Coding Corner</a>  
	.
		.
	1116 views	
	 . <a href="../../../ikke/2005/11/05/maemo_and_mdns.html#comments" title="Display comments / Leave a comment">4 comments</a>	  	</div>
	</div>
<h2>11/03/05</h2><div class="bPost" lang="en-US">
		<div class="title">Using C++ classes in C</div>
	<div class="bText">
		<p>Today I had a little chat with <a href="http://blogs.gnome.org/portal/michiels" title="Michiel">Michiel</a> on #gnome-nl regarding the use of C++ classes in C code (he started learning C again ;-)).</p>

<p>I was fascinated (well, sort of) by this, and tried to get something working. Here's the result:</p>

<ul><li><p>First we need a C++ class, using one header file (Test.hh)</p>
<pre><code>class Test {
        public:
                void testfunc();
                Test(int i);

        private:
                int testint;
};
</code></pre>
<p>and one implementation file (Test.cc)</p>
<pre><code>#include &lt;iostream&gt;
#include "Test.hh"

using namespace std;

Test::Test(int i) {
        this->testint = i;
}

void Test::testfunc() {
        cout &lt;&lt; "test " &lt;&lt; this->testint &lt;&lt; endl;
}</code></pre>

<p>This is just basic C++ code.</p></li>
<li><p>Then we need some glue code. This code is something in-between C and C++. Again, we got one header file (TestWrapper.h, just .h as it doesn't contain any C++ code)</p>
<pre><code>typedef void CTest;

#ifdef __cplusplus
extern "C" {
#endif
CTest * test_new(int i);
void test_testfunc(const CTest *t);
void test_delete(CTest *t);
#ifdef __cplusplus
}
#endif
</code></pre>
<p>and the function implementations (TestWrapper.cc, .cc as it contains C++ code):</p>
<pre><code>#include "TestWrapper.h"
#include "Test.hh"

extern "C" {

CTest * test_new(int i) {
       Test *t = new Test(i);

       return (CTest *)t;
}

void test_testfunc(const CTest *test) {
        Test *t = (Test *)test;
        t->testfunc();
}

void test_delete(CTest *test) {
        Test *t = (Test *)test;

        delete t;
}
}
</code></pre>

<p>Some things you should notice:</p>
<ol><li><code>typedef void CTest</code><br />
We typedef CTest to void. This way we can use "CTest *" in our C code as if it's a normal C type, whilst we have compile-time type checks (sort of at least  :-)), and it's cleaner than always using "void *"</li><br />
<li><p>The use of "extern "C" { }" around all functions (both definitions and implementations). We need this so the compiler won't <a href="http://en.wikipedia.org/wiki/Name_mangling#Name_mangling_in_C.2B.2B" title="name-mangle">name-mangle</a> the resulting binaries. If you want to see what name-mangling is:</p>
<pre>$ cat test.c
#include &lt;iostream&gt;
using namespace std;

void test() {
        cout &lt;&lt; "test" &lt;&lt; endl;
}

int main(int argc, char *argv[]) {
        test();
        return 0;
}
$ g++ -o nmtest test.c
$ ./nmtest
test
$ nm nmtest
***blablabla***
08048818 t _Z41__static_initialization_and_destruction_0ii
080487c4 T _Z4testv
         U _ZNKSs4sizeEv@@GLIBCXX_3.4
         U _ZNKSsixEj@@GLIBCXX_3.4
***blablabla***</pre>
<p>As you can see, our "test()" function has been renamed to "_Z4testv" by the compiler. This is needed to allow polyphormism in C++, but we don't want this in our C wrapper of course, as we want to know the name of the function we will call!<br />
This implies we need another function name for every polyphormistic (SP?) class function of our C++ class in the C wrapper.</p></li></ol>
</li>
<li><p>At last, we need some code to test our work (main.c):</p>
<pre><code>#include &lt;stdio.h&gt;
#include "TestWrapper.h"

int main() {
        CTest *t = NULL;

        t = test_new(5);
        test_testfunc(t);
        test_delete(t);
        t = NULL;

        return 0;
}
</code></pre>
<p>This is, once more, braindead simple (C) code, where we use the functions defined in TestWrapper.h.</p>
</li>
<li><p>Last but not least, we need to compile everything. I made a basic Makefile to do this (Makefile):</p>
<pre>CFLAGS=-Wall -Werror -g -ansi -pedantic -std=c89
CCFLAGS=-Wall -Werror -g
LDFLAGS=-g -Wall -lstdc++

OBJS=Test.o TestWrapper.o main.o
PROG=test

all: $(PROG)
default: all

%.o: %.cc
        $(CC) $(CCFLAGS) -c $&lt;

%.o: %.c
        $(CC) $(CFLAGS) -c $&lt;

$(PROG): $(OBJS)
        $(CC) $(OBJS) $(LDFLAGS) -o $@

clean:
        rm -f $(OBJS)
        rm -f $(PROG)
</pre>
</li></ul>
<p>Now we can simply call "make" to build the project:</p>
<pre>$ make
cc -Wall -Werror -g -c Test.cc
cc -Wall -Werror -g -c TestWrapper.cc
cc -Wall -Werror -g -ansi -pedantic -std=c89 -c main.c
cc Test.o TestWrapper.o main.o -g -Wall -lstdc++ -o test</pre>
<p>Finally, we test the resulting binary:</p>
<pre>$ ./test
test 5</pre>
<p>which is the expected result.</p>

<p>Obviously, writing a wrapper like this by hand can be a boring task. It might be possible to automate/script this, but I don't know whether the result is worth the time one puts into it. Just use plain C, we don't need C++ ;-)</p>			</div>
         <div class="bSmallPrint">
	  <a href="../../../ikke/2005/11/03/using_c_classes_in_c.html" title="Permanent link to full entry" class="permalink_right"><img src="../../../../skins/plain/images/chain_link.gif" alt="Permalink" width="14" height="14" border="0" class="middle" /></a>
	  .
          <a href="../../../all7441.html?author=" title="Browse all posts by this author">Ikke</a>

          .
	  10:40:42 pm	  .

          678 Words          .
	  
	<a href="../../../ikke3f99.html?cat=16" title="true">Technology</a>, <a href="../../../ikke3cd0.html?cat=49" title="true">Coding Corner</a>  
	.
		.
	7779 views	
	 . <a href="../../../ikke/2005/11/03/using_c_classes_in_c.html#comments" title="Display comments / Leave a comment">2 comments</a>	  	</div>
	</div>
<div class="bPost" lang="en-US">
		<div class="title">Scratchbox working</div>
	<div class="bText">
		<p>Thanks to Bram (and <a href="http://www.vtk.ugent.be/" title="VTK">VTK</a> Computer) I got an old 20Gb hard drive, which I needed to be able to install a <a href="http://www.scratchbox.org/" title="Scratchbox">Scratchbox</a> environment and play around with the <a href="http://www.maemo.org/" title="Maemo">Maemo</a> platform.<br />
I managed to install everything by now (although I had one <a href="http://forums.gentoo.org/viewtopic-t-386131-highlight-.html" title="crash">crash</a> again :-(), so I hope I'll be able to start hacking on some apps/libs soon. One of the things I'd love to get working is <a href="http://www.freedesktop.org/Software/Avahi" title="Avahi">Avahi</a>, the GPL'ed mDNS stack.</p>

<p>The obligatory shot:<br />
<center><img src="http://www.eikke.com/files/maemo-scratchbox-xephyr.png" title="Maemo Scratchbox Xephyr" /></center></p>

<p>I just followed <a href="http://maemo.org/platform/docs/tutorials/Maemo_tutorial.html#settingup" title="these">these</a> steps. They contain one error though: when editing your ~/.bash_profile, you got to add a line containing<br />
<center><code>export LC_ALL=en_GB</code></center><br />
too.</p>			</div>
         <div class="bSmallPrint">
	  <a href="../../../ikke/2005/11/03/scratchbox_working.html" title="Permanent link to full entry" class="permalink_right"><img src="../../../../skins/plain/images/chain_link.gif" alt="Permalink" width="14" height="14" border="0" class="middle" /></a>
	  .
          <a href="../../../all7441.html?author=" title="Browse all posts by this author">Ikke</a>

          .
	  10:15:20 pm	  .

          152 Words          .
	  
	<a href="../../../ikke3f99.html?cat=16" title="true">Technology</a>, <a href="../../../ikkec055.html?cat=17" title="true">Linux</a>, <a href="../../../ikke8e7f.html?cat=19" title="true">Desktop</a>, <a href="../../../ikke3cd0.html?cat=49" title="true">Coding Corner</a>  
	.
		.
	736 views	
	 . <a href="../../../ikke/2005/11/03/scratchbox_working.html#comments" title="Display comments / Leave a comment">3 comments</a>	  	</div>
	</div>

<p class="center"><strong>
		</strong></p>

	
							
						
		  </div>
		
  </div>
  <br clear="all" />
  <div id="footer">
  <!-- This is the footer. Put all your copyright info here. -->
  <br />
  Design by <a href="http://www.jameskoster.co.uk/">James Koster</a>, Evoskin by <a href="http://www.brendoman.com/dbc">Danny Ferguson</a></div>
</center>
</body>

<!-- Mirrored from blog.eikke.com/index.php/all/2005/11/?blog=1&m=200511 by HTTrack Website Copier/3.x [XR&CO'2010], Tue, 11 Dec 2012 19:46:56 GMT -->
</html>
